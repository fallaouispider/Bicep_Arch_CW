<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Low-Level Design documentation for Azure Bicep Infrastructure deployment">
    <meta name="author" content="Cloud Architecture Team">
    <title>Azure Infrastructure - Low-Level Design (LLD)</title>
    
    <!-- Mermaid.js for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    
    <style>
        /* ==================== ROOT VARIABLES ==================== */
        :root {
            --azure-blue: #0078d4;
            --azure-dark-blue: #004578;
            --azure-light-blue: #50e6ff;
            --azure-gray: #5e5e5e;
            --background-white: #ffffff;
            --background-light: #f5f5f5;
            --background-dark: #1e1e1e;
            --text-primary: #323130;
            --text-secondary: #605e5c;
            --border-color: #edebe9;
            --success-green: #107c10;
            --warning-orange: #ff8c00;
            --error-red: #d13438;
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.15);
            --shadow-lg: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        /* ==================== GLOBAL STYLES ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background-color: var(--background-light);
            padding: 0;
            margin: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ==================== HEADER ==================== */
        .header {
            background: linear-gradient(135deg, var(--azure-dark-blue) 0%, var(--azure-blue) 100%);
            color: white;
            padding: 40px 20px;
            box-shadow: var(--shadow-md);
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .header .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .header .metadata {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            font-size: 0.95rem;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .metadata-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .metadata-item strong {
            font-weight: 600;
        }

        /* ==================== TABLE OF CONTENTS ==================== */
        .toc {
            background: var(--background-white);
            border-radius: 8px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-sm);
            border-left: 4px solid var(--azure-blue);
        }

        .toc h2 {
            color: var(--azure-blue);
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .toc-list {
            list-style: none;
            padding-left: 0;
        }

        .toc-list li {
            margin: 12px 0;
            padding-left: 20px;
            position: relative;
        }

        .toc-list li::before {
            content: "‚ñ∏";
            position: absolute;
            left: 0;
            color: var(--azure-blue);
            font-weight: bold;
        }

        .toc-list a {
            color: var(--text-primary);
            text-decoration: none;
            transition: color 0.3s ease;
            font-size: 1.05rem;
        }

        .toc-list a:hover {
            color: var(--azure-blue);
            text-decoration: underline;
        }

        .toc-list ul {
            margin-left: 20px;
            margin-top: 8px;
        }

        /* ==================== SECTIONS ==================== */
        .section {
            background: var(--background-white);
            border-radius: 8px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-sm);
            scroll-margin-top: 20px;
        }

        .section h2 {
            color: var(--azure-dark-blue);
            margin-bottom: 25px;
            font-size: 2rem;
            border-bottom: 3px solid var(--azure-blue);
            padding-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section h3 {
            color: var(--azure-blue);
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .section h4 {
            color: var(--azure-gray);
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .section p {
            margin-bottom: 15px;
            color: var(--text-secondary);
            line-height: 1.7;
        }

        /* ==================== CARDS ==================== */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .card {
            background: var(--background-light);
            border-radius: 8px;
            padding: 25px;
            border-left: 4px solid var(--azure-blue);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-md);
        }

        .card h4 {
            color: var(--azure-dark-blue);
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .card p {
            margin-bottom: 10px;
            font-size: 0.95rem;
        }

        .card .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-top: 10px;
        }

        .badge-dev {
            background-color: #e3f2fd;
            color: #1976d2;
        }

        .badge-prod {
            background-color: #ffebee;
            color: #c62828;
        }

        .badge-network {
            background-color: #e8f5e9;
            color: var(--success-green);
        }

        .badge-compute {
            background-color: #fff3e0;
            color: var(--warning-orange);
        }

        .badge-data {
            background-color: #f3e5f5;
            color: #7b1fa2;
        }

        /* ==================== TABLES ==================== */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            background: var(--background-white);
            box-shadow: var(--shadow-sm);
            border-radius: 8px;
            overflow: hidden;
        }

        thead {
            background: var(--azure-blue);
            color: white;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            font-weight: 600;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        tbody tr:hover {
            background-color: var(--background-light);
        }

        tbody tr:last-child td {
            border-bottom: none;
        }

        td code {
            background: var(--background-light);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: var(--error-red);
        }

        /* ==================== CODE BLOCKS ==================== */
        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            box-shadow: var(--shadow-sm);
        }

        code {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        pre code {
            background: transparent;
            padding: 0;
            color: inherit;
        }

        /* ==================== DIAGRAMS ==================== */
        .diagram-container {
            background: var(--background-white);
            padding: 30px;
            border-radius: 8px;
            margin: 30px 0;
            box-shadow: var(--shadow-sm);
            overflow-x: auto;
        }

        .diagram-container h3 {
            margin-top: 0;
            margin-bottom: 20px;
            color: var(--azure-dark-blue);
        }

        .mermaid {
            display: flex;
            justify-content: center;
            min-height: 400px;
        }

        /* ==================== COLLAPSIBLE SECTIONS ==================== */
        .collapsible {
            background-color: var(--background-light);
            color: var(--text-primary);
            cursor: pointer;
            padding: 18px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 8px;
            margin-top: 15px;
            transition: background-color 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .collapsible:hover {
            background-color: var(--border-color);
        }

        .collapsible.active {
            background-color: var(--azure-blue);
            color: white;
        }

        .collapsible::after {
            content: '‚ñº';
            font-size: 0.9rem;
            transition: transform 0.3s ease;
        }

        .collapsible.active::after {
            transform: rotate(-180deg);
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background-color: var(--background-white);
            border-radius: 0 0 8px 8px;
        }

        .collapsible-content.active {
            max-height: 5000px;
            padding: 20px;
            border: 1px solid var(--border-color);
            border-top: none;
        }

        /* ==================== BADGES & LABELS ==================== */
        .status-badge {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 16px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-deployed {
            background-color: #d4edda;
            color: #155724;
        }

        .status-optional {
            background-color: #fff3cd;
            color: #856404;
        }

        .status-required {
            background-color: #f8d7da;
            color: #721c24;
        }

        /* ==================== HIGHLIGHTS ==================== */
        .highlight-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-left: 5px solid var(--azure-blue);
            padding: 20px;
            border-radius: 8px;
            margin: 25px 0;
        }

        .highlight-box h4 {
            color: var(--azure-dark-blue);
            margin-top: 0;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 5px solid var(--warning-orange);
            padding: 20px;
            border-radius: 8px;
            margin: 25px 0;
        }

        .warning-box h4 {
            color: var(--warning-orange);
            margin-top: 0;
        }

        .info-box {
            background: #e7f3ff;
            border-left: 5px solid #2196f3;
            padding: 20px;
            border-radius: 8px;
            margin: 25px 0;
        }

        .info-box h4 {
            color: #1976d2;
            margin-top: 0;
        }

        /* ==================== LISTS ==================== */
        ul, ol {
            margin: 15px 0;
            padding-left: 30px;
        }

        li {
            margin: 8px 0;
            color: var(--text-secondary);
        }

        /* ==================== FOOTER ==================== */
        .footer {
            background: var(--azure-dark-blue);
            color: white;
            text-align: center;
            padding: 30px 20px;
            margin-top: 50px;
        }

        .footer p {
            margin: 5px 0;
            color: rgba(255, 255, 255, 0.8);
        }

        /* ==================== RESPONSIVE DESIGN ==================== */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .section {
                padding: 25px;
            }

            .card-grid {
                grid-template-columns: 1fr;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: 10px;
            }
        }

        /* ==================== PRINT STYLES ==================== */
        @media print {
            body {
                background: white;
            }

            .header {
                background: white;
                color: black;
                border-bottom: 3px solid black;
            }

            .section, .card, .diagram-container {
                box-shadow: none;
                page-break-inside: avoid;
            }

            .collapsible-content {
                max-height: none !important;
                display: block !important;
            }

            .collapsible::after {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- ==================== HEADER ==================== -->
    <header class="header">
        <div class="container">
            <h1>üèóÔ∏è Azure Infrastructure - Low-Level Design</h1>
            <p class="subtitle">Complete Bicep Infrastructure Deployment Architecture</p>
            <div class="metadata">
                <div class="metadata-item">
                    <strong>Project:</strong> <span>Bicep_Arch_CW</span>
                </div>
                <div class="metadata-item">
                    <strong>Version:</strong> <span>1.0.0</span>
                </div>
                <div class="metadata-item">
                    <strong>Date:</strong> <span>January 15, 2026</span>
                </div>
                <div class="metadata-item">
                    <strong>Scope:</strong> <span>Subscription Level</span>
                </div>
                <div class="metadata-item">
                    <strong>Environments:</strong> <span>Development, Production</span>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- ==================== TABLE OF CONTENTS ==================== -->
        <nav class="toc">
            <h2>üìë Table of Contents</h2>
            <ul class="toc-list">
                <li><a href="#overview">1. Architecture Overview</a></li>
                <li><a href="#resources">2. Resource Inventory</a></li>
                <li><a href="#network">3. Network Architecture</a>
                    <ul>
                        <li><a href="#network-topology">3.1 Network Topology</a></li>
                        <li><a href="#network-security">3.2 Security Groups</a></li>
                        <li><a href="#network-address">3.3 Address Planning</a></li>
                    </ul>
                </li>
                <li><a href="#modules">4. Module Specifications</a>
                    <ul>
                        <li><a href="#module-vnet">4.1 Virtual Network Module</a></li>
                        <li><a href="#module-appgw">4.2 Application Gateway Module</a></li>
                        <li><a href="#module-aks">4.3 Azure Kubernetes Service Module</a></li>
                        <li><a href="#module-cosmos">4.4 Cosmos DB Module</a></li>
                        <li><a href="#module-sql">4.5 SQL Server Module</a></li>
                        <li><a href="#module-servicebus">4.6 Service Bus Module</a></li>
                        <li><a href="#module-apim">4.7 API Management Module</a></li>
                    </ul>
                </li>
                <li><a href="#security">5. Security Configuration</a></li>
                <li><a href="#dependencies">6. Resource Dependencies</a></li>
                <li><a href="#deployment">7. Deployment Configuration</a></li>
                <li><a href="#naming">8. Naming Conventions</a></li>
            </ul>
        </nav>

        <!-- ==================== 1. ARCHITECTURE OVERVIEW ==================== -->
        <section id="overview" class="section">
            <h2>üèõÔ∏è 1. Architecture Overview</h2>
            
            <p>This document provides comprehensive Low-Level Design documentation for a complete enterprise-grade Azure infrastructure deployment using Bicep Infrastructure as Code. The architecture implements a modern, scalable, and secure cloud infrastructure following Azure Well-Architected Framework principles.</p>

            <div class="highlight-box">
                <h4>üéØ Key Architecture Characteristics</h4>
                <ul>
                    <li><strong>Deployment Scope:</strong> Subscription-level orchestration</li>
                    <li><strong>Architecture Pattern:</strong> Modular microservices with centralized networking</li>
                    <li><strong>Security Model:</strong> Zero-trust with private connectivity</li>
                    <li><strong>Scalability:</strong> Autoscaling compute and serverless data services</li>
                    <li><strong>High Availability:</strong> Zone redundancy and geo-redundant backups</li>
                </ul>
            </div>

            <h3>Core Components</h3>
            <div class="card-grid">
                <div class="card">
                    <h4>üåê Networking Layer</h4>
                    <p>Virtual Network with multiple subnets, NSG-based security, and private connectivity</p>
                    <span class="badge badge-network">Foundation</span>
                </div>
                <div class="card">
                    <h4>‚öôÔ∏è Compute Layer</h4>
                    <p>Azure Kubernetes Service (AKS) with autoscaling and Application Gateway Ingress Controller (AGIC)</p>
                    <span class="badge badge-compute">Workload</span>
                </div>
                <div class="card">
                    <h4>üíæ Data Layer</h4>
                    <p>Cosmos DB (NoSQL Serverless) and Azure SQL Server with private endpoints</p>
                    <span class="badge badge-data">Persistence</span>
                </div>
                <div class="card">
                    <h4>üì® Messaging Layer</h4>
                    <p>Service Bus with queues and topics for reliable message delivery</p>
                    <span class="badge badge-data">Integration</span>
                </div>
                <div class="card">
                    <h4>üö™ Gateway Layer</h4>
                    <p>Application Gateway v2 with WAF and API Management for secure ingress</p>
                    <span class="badge badge-network">Entry Point</span>
                </div>
                <div class="card">
                    <h4>üîí Security Layer</h4>
                    <p>Managed identities, private endpoints, NSG rules, and TLS 1.2 enforcement</p>
                    <span class="badge badge-network">Protection</span>
                </div>
            </div>

            <h3>Design Principles</h3>
            <ul>
                <li><strong>Modularity:</strong> Separate Bicep modules for each service layer enabling reusability and maintainability</li>
                <li><strong>Security by Default:</strong> Private endpoints, NSG restrictions, and managed identities</li>
                <li><strong>Infrastructure as Code:</strong> Complete automation with parameterized deployments</li>
                <li><strong>Environment Isolation:</strong> Separate configurations and network spaces for dev/prod</li>
                <li><strong>Observability:</strong> Diagnostic settings and Azure Monitor integration</li>
                <li><strong>Cost Optimization:</strong> Serverless options, autoscaling, and right-sized SKUs</li>
            </ul>

            <h3>Complete Architecture Diagram</h3>
            <div class="diagram-container">
                <p style="margin-bottom: 20px; color: var(--text-secondary);">This diagram illustrates the complete Azure infrastructure deployment with all resources, their relationships, and integration points across networking, compute, data, messaging, and gateway layers.</p>
                <div class="mermaid">
                    graph TB
                        Internet[Internet]
                        Users[End Users]
                        
                        subgraph Azure[Azure Subscription]
                            subgraph RG[Resource Group]
                                
                                subgraph Network[Networking Layer]
                                    VNet[Virtual Network<br/>Dev: 10.1.0.0/16<br/>Prod: 10.0.0.0/16]
                                    
                                    subgraph Subnet1[Workload Subnet 10.x.0.0/24]
                                        NSG1[NSG Workload]
                                        SE[Service Endpoints]
                                    end
                                    
                                    subgraph Subnet2[App Gateway Subnet 10.x.1.0/24]
                                        NSG2[NSG Gateway]
                                        PIP[Public IP Standard]
                                    end
                                end
                                
                                subgraph Gateway[Gateway and Integration]
                                    AppGW[Application Gateway v2<br/>Dev: Standard v2<br/>Prod: WAF v2]
                                    APIM[API Management<br/>Developer Tier<br/>External VNet]
                                    UAMI[User Assigned<br/>Managed Identity]
                                end
                                
                                subgraph Compute[Compute Layer]
                                    AKS[Azure Kubernetes Service<br/>Version 1.29.0<br/>Dev: 2 nodes 1-3<br/>Prod: 3 nodes 3-10]
                                    AGIC[AGIC Addon<br/>Ingress Controller]
                                    AKS_ID[AKS Managed Identity]
                                    NodeRG[Node Resource Group<br/>VMSS Disks LB]
                                end
                                
                                subgraph Data[Data Layer]
                                    subgraph CosmosGroup[Cosmos DB]
                                        Cosmos[NoSQL Serverless<br/>TLS 1.2]
                                        CosmosDB[Database appdb]
                                        Container1[Container products]
                                        Container2[Container users]
                                        Container3[Container orders Prod]
                                        PE_Cosmos[Private Endpoint Cosmos]
                                        Cosmos_ID[Cosmos Identity]
                                    end
                                    
                                    subgraph SQLGroup[SQL Server]
                                        SQLServer[Azure SQL Server<br/>Version 12.0 TLS 1.2]
                                        DB1[CWDB GP Gen5 2<br/>Dev 32GB Prod 100GB]
                                        DB2[CW-Utility GP Gen5 2<br/>Dev 32GB Prod 50GB]
                                        DB3[sql01-nonprd-emea-db<br/>Dev 32GB Prod 100GB]
                                        PE_SQL[Private Endpoint SQL]
                                        SQL_ID[SQL Identity]
                                    end
                                end
                                
                                subgraph Messaging[Messaging Layer]
                                    SB[Service Bus Standard<br/>TLS 1.2]
                                    Q1[Queue orders 1-2GB]
                                    Q2[Queue notifications 1GB]
                                    Q3[Queue payments 2GB Prod]
                                    T1[Topic events 1-2GB]
                                    T1S1[Sub all-events]
                                    T2[Topic audit 2GB Prod]
                                    T2S1[Sub audit-processor]
                                    PE_SB[Private Endpoint SB Premium]
                                    SB_ID[SB Identity]
                                end
                                
                                subgraph Monitoring[Monitoring Optional Prod]
                                    LAW[Log Analytics Workspace<br/>NSG AKS AppGW Logs]
                                end
                            end
                        end
                        
                        Users --> Internet
                        Internet --> PIP
                        PIP --> AppGW
                        AppGW --> AGIC
                        AGIC --> AppGW
                        AppGW --> AKS
                        APIM --> AKS
                        
                        VNet --> Subnet1
                        VNet --> Subnet2
                        Subnet1 --> NSG1
                        Subnet2 --> NSG2
                        Subnet1 --> SE
                        Subnet2 --> PIP
                        
                        AKS --> Subnet1
                        AKS --> AGIC
                        AKS --> AKS_ID
                        AKS --> NodeRG
                        AGIC --> UAMI
                        AppGW --> UAMI
                        
                        AKS --> PE_Cosmos
                        PE_Cosmos --> Cosmos
                        Cosmos --> CosmosDB
                        CosmosDB --> Container1
                        CosmosDB --> Container2
                        CosmosDB --> Container3
                        Cosmos --> Cosmos_ID
                        
                        AKS --> PE_SQL
                        PE_SQL --> SQLServer
                        SQLServer --> DB1
                        SQLServer --> DB2
                        SQLServer --> DB3
                        SQLServer --> SQL_ID
                        
                        AKS --> SB
                        AKS -.-> PE_SB
                        PE_SB -.-> SB
                        SB --> Q1
                        SB --> Q2
                        SB --> Q3
                        SB --> T1
                        T1 --> T1S1
                        SB --> T2
                        T2 --> T2S1
                        SB --> SB_ID
                        
                        PE_Cosmos --> Subnet1
                        PE_SQL --> Subnet1
                        PE_SB -.-> Subnet1
                        APIM --> Subnet1
                        
                        AppGW -.-> LAW
                        AKS -.-> LAW
                        Cosmos -.-> LAW
                        SQLServer -.-> LAW
                        SB -.-> LAW
                        NSG1 -.-> LAW
                        NSG2 -.-> LAW
                        
                        classDef azureBlue fill:#0078d4,stroke:#004578,stroke-width:2px,color:#fff
                        classDef network fill:#e3f2fd,stroke:#0078d4,stroke-width:2px,color:#000
                        classDef compute fill:#fff3e0,stroke:#ff8c00,stroke-width:2px,color:#000
                        classDef data fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#000
                        classDef messaging fill:#fce4ec,stroke:#c2185b,stroke-width:2px,color:#000
                        classDef gateway fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px,color:#000
                        classDef security fill:#ffebee,stroke:#c62828,stroke-width:2px,color:#000
                        classDef external fill:#f5f5f5,stroke:#5e5e5e,stroke-width:2px,color:#000
                        classDef monitoring fill:#fff9c4,stroke:#f57f17,stroke-width:2px,color:#000
                        
                        class Azure,RG azureBlue
                        class Network,VNet,Subnet1,Subnet2,NSG1,NSG2,PIP,SE network
                        class Compute,AKS,AGIC,NodeRG compute
                        class Data,CosmosGroup,Cosmos,CosmosDB,Container1,Container2,Container3,SQLGroup,SQLServer,DB1,DB2,DB3 data
                        class Messaging,SB,Q1,Q2,Q3,T1,T1S1,T2,T2S1 messaging
                        class Gateway,AppGW,APIM gateway
                        class PE_Cosmos,PE_SQL,PE_SB,UAMI,AKS_ID,Cosmos_ID,SQL_ID,SB_ID security
                        class Internet,Users external
                        class Monitoring,LAW monitoring
                </div>
            </div>

            <h3>Architecture Flow</h3>
            <div class="card-grid">
                <div class="card">
                    <h4>1Ô∏è‚É£ Ingress Flow</h4>
                    <p><strong>Users</strong> ‚Üí Internet ‚Üí <strong>Public IP</strong> ‚Üí <strong>Application Gateway</strong> ‚Üí <strong>AKS Cluster</strong></p>
                    <span class="badge badge-network">Layer 7 Routing</span>
                </div>
                <div class="card">
                    <h4>2Ô∏è‚É£ Service Communication</h4>
                    <p><strong>AKS Pods</strong> ‚Üí <strong>Private Endpoints</strong> ‚Üí <strong>Cosmos DB / SQL Server</strong></p>
                    <span class="badge badge-data">Secure Data Access</span>
                </div>
                <div class="card">
                    <h4>3Ô∏è‚É£ Async Messaging</h4>
                    <p><strong>AKS Services</strong> ‚Üí <strong>Service Endpoints</strong> ‚Üí <strong>Service Bus</strong> (Queues/Topics)</p>
                    <span class="badge badge-data">Decoupled Communication</span>
                </div>
                <div class="card">
                    <h4>4Ô∏è‚É£ API Management</h4>
                    <p><strong>External APIs</strong> ‚Üí <strong>APIM</strong> ‚Üí <strong>AKS Services</strong></p>
                    <span class="badge badge-network">API Gateway Pattern</span>
                </div>
                <div class="card">
                    <h4>5Ô∏è‚É£ Ingress Control</h4>
                    <p><strong>Kubernetes Ingress</strong> ‚Üí <strong>AGIC Addon</strong> ‚Üí <strong>App Gateway Configuration</strong></p>
                    <span class="badge badge-compute">Dynamic Routing</span>
                </div>
                <div class="card">
                    <h4>6Ô∏è‚É£ Monitoring Flow</h4>
                    <p><strong>All Resources</strong> ‚Üí <strong>Diagnostic Settings</strong> ‚Üí <strong>Log Analytics Workspace</strong></p>
                    <span class="badge badge-compute">Observability</span>
                </div>
            </div>
        </section>

        <!-- ==================== 2. RESOURCE INVENTORY ==================== -->
        <section id="resources" class="section">
            <h2>üì¶ 2. Resource Inventory</h2>
            
            <p>Complete inventory of all Azure resources deployed by this infrastructure template.</p>

            <h3>Resource Summary</h3>
            <table>
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Resource Type</th>
                        <th>Count</th>
                        <th>Environment</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Foundation</td>
                        <td>Resource Group</td>
                        <td>1</td>
                        <td>Both</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Networking</td>
                        <td>Virtual Network</td>
                        <td>1</td>
                        <td>Both</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Networking</td>
                        <td>Subnets</td>
                        <td>2</td>
                        <td>Both</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Networking</td>
                        <td>Network Security Groups</td>
                        <td>2</td>
                        <td>Both</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Networking</td>
                        <td>Public IP Address</td>
                        <td>1</td>
                        <td>Both</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Networking</td>
                        <td>Application Gateway v2</td>
                        <td>1</td>
                        <td>Both</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Networking</td>
                        <td>Private Endpoints</td>
                        <td>2-3</td>
                        <td>Both</td>
                        <td><span class="status-badge status-optional">Optional</span></td>
                    </tr>
                    <tr>
                        <td>Compute</td>
                        <td>Azure Kubernetes Service</td>
                        <td>1</td>
                        <td>Both</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Database</td>
                        <td>Cosmos DB Account</td>
                        <td>1</td>
                        <td>Both</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Database</td>
                        <td>Cosmos DB Database</td>
                        <td>1</td>
                        <td>Both</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Database</td>
                        <td>Cosmos DB Containers</td>
                        <td>2-3</td>
                        <td>Dev/Prod</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Database</td>
                        <td>Azure SQL Server</td>
                        <td>1</td>
                        <td>Both</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Database</td>
                        <td>SQL Databases</td>
                        <td>3</td>
                        <td>Both</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Messaging</td>
                        <td>Service Bus Namespace</td>
                        <td>1</td>
                        <td>Both</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Messaging</td>
                        <td>Service Bus Queues</td>
                        <td>2-3</td>
                        <td>Dev/Prod</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Messaging</td>
                        <td>Service Bus Topics</td>
                        <td>1-2</td>
                        <td>Dev/Prod</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Integration</td>
                        <td>API Management</td>
                        <td>1</td>
                        <td>Both</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Identity</td>
                        <td>System-Assigned Managed Identities</td>
                        <td>5</td>
                        <td>Both</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                    <tr>
                        <td>Identity</td>
                        <td>User-Assigned Managed Identity</td>
                        <td>1</td>
                        <td>Both</td>
                        <td><span class="status-badge status-deployed">Deployed</span></td>
                    </tr>
                </tbody>
            </table>

            <div class="info-box">
                <h4>‚ÑπÔ∏è Note on Resource Counts</h4>
                <p>Resource counts may vary based on environment configuration and optional feature flags. Some resources like private endpoints are conditionally deployed based on SKU tiers and security requirements.</p>
            </div>
        </section>

        <!-- ==================== 3. NETWORK ARCHITECTURE ==================== -->
        <section id="network" class="section">
            <h2>üåê 3. Network Architecture</h2>
            
            <p>The network architecture provides a secure, isolated environment with multiple subnets for workload segregation and comprehensive security controls.</p>

            <!-- 3.1 Network Topology -->
            <h3 id="network-topology">3.1 Network Topology</h3>
            
            <div class="diagram-container">
                <h3>Network Topology and Traffic Flow</h3>
                <div class="mermaid">
                    graph LR
                        Internet[Internet<br/>0.0.0.0/0]
                        
                        subgraph VNet[Virtual Network 10.x.0.0/16]
                            direction TB
                            
                            subgraph Subnet1[Workload Subnet 10.x.0.0/24<br/>251 usable IPs]
                                direction TB
                                NSG1[NSG Workload<br/>5 Inbound Rules<br/>3 Outbound Rules]
                                SE1[Service Endpoints<br/>CosmosDB SQL ServiceBus<br/>Storage KeyVault APIM]
                                AKS1[AKS Nodes<br/>Azure CNI<br/>10.x.0.4-10.x.0.254]
                                PE1[Private Endpoints<br/>Cosmos DB PE<br/>SQL Server PE<br/>Service Bus PE]
                                APIM1[API Management<br/>External VNet Mode<br/>10.x.0.x]
                            end
                            
                            subgraph Subnet2[App Gateway Subnet 10.x.1.0/24<br/>251 usable IPs]
                                direction TB
                                NSG2[NSG AppGateway<br/>4 Inbound Rules<br/>1 Outbound Rule]
                                AppGW1[Application Gateway<br/>Frontend IP<br/>10.x.1.4]
                                PIP1[Public IP<br/>Static Standard<br/>xx.xx.xx.xx]
                            end
                        end
                        
                        subgraph External[External Services]
                            Cosmos[Cosmos DB<br/>cosmos-webapp.documents.azure.com]
                            SQL[SQL Server<br/>sql-webapp.database.windows.net]
                            SBus[Service Bus<br/>sb-webapp.servicebus.windows.net]
                        end
                        
                        Internet -->|Port 443 80| PIP1
                        PIP1 --> AppGW1
                        AppGW1 -->|Backend Pool| AKS1
                        AKS1 -->|AGIC Controls| AppGW1
                        APIM1 -->|API Traffic| AKS1
                        
                        PE1 -->|Private Link| Cosmos
                        PE1 -->|Private Link| SQL
                        PE1 -->|Private Link Premium| SBus
                        
                        AKS1 -->|Via Private Endpoint| PE1
                        AKS1 -->|Via Service Endpoint| SE1
                        SE1 -->|Direct Access| SBus
                        
                        NSG1 -.->|Protects| Subnet1
                        NSG2 -.->|Protects| Subnet2
                        
                        classDef vnetStyle fill:#e3f2fd,stroke:#0078d4,stroke-width:3px
                        classDef subnetStyle fill:#bbdefb,stroke:#1976d2,stroke-width:2px
                        classDef nsgStyle fill:#ffebee,stroke:#c62828,stroke-width:2px
                        classDef computeStyle fill:#fff3e0,stroke:#ff8c00,stroke-width:2px
                        classDef dataStyle fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
                        classDef gatewayStyle fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
                        classDef externalStyle fill:#f5f5f5,stroke:#5e5e5e,stroke-width:2px
                        
                        class VNet vnetStyle
                        class Subnet1,Subnet2 subnetStyle
                        class NSG1,NSG2 nsgStyle
                        class AKS1 computeStyle
                        class PE1,Cosmos,SQL,SBus dataStyle
                        class AppGW1,PIP1,APIM1 gatewayStyle
                        class Internet,External externalStyle
                </div>
            </div>
            
            <h4>Traffic Flow Patterns</h4>
            <div class="card-grid">
                <div class="card">
                    <h4>1. Inbound Internet Traffic</h4>
                    <p><strong>Path:</strong> Internet ‚Üí Public IP (Standard) ‚Üí Application Gateway (Port 443/80) ‚Üí AKS Pods (via AGIC)</p>
                    <p><strong>Security:</strong> NSG rules on App Gateway subnet, WAF policies (Prod), TLS termination</p>
                    <span class="badge badge-network">North-South</span>
                </div>
                <div class="card">
                    <h4>2. Database Access (Cosmos DB)</h4>
                    <p><strong>Path:</strong> AKS Pods ‚Üí Private Endpoint (10.x.0.x) ‚Üí Private Link ‚Üí Cosmos DB Account</p>
                    <p><strong>Security:</strong> No public access, encrypted in transit (TLS 1.2), NSG rules</p>
                    <span class="badge badge-data">East-West</span>
                </div>
                <div class="card">
                    <h4>3. Database Access (SQL Server)</h4>
                    <p><strong>Path:</strong> AKS Pods ‚Üí Private Endpoint (10.x.0.x) ‚Üí Private Link ‚Üí SQL Server</p>
                    <p><strong>Security:</strong> No public access, TDE enabled, connection encrypted (TLS 1.2)</p>
                    <span class="badge badge-data">East-West</span>
                </div>
                <div class="card">
                    <h4>4. Messaging (Service Bus)</h4>
                    <p><strong>Path:</strong> AKS Pods ‚Üí Service Endpoint ‚Üí Service Bus Namespace (Standard)</p>
                    <p><strong>Alternative:</strong> Private Endpoint available with Premium SKU</p>
                    <span class="badge badge-data">East-West</span>
                </div>
                <div class="card">
                    <h4>5. API Management Traffic</h4>
                    <p><strong>Path:</strong> External Clients ‚Üí APIM (External VNet) ‚Üí AKS Services (Internal)</p>
                    <p><strong>Security:</strong> API policies, subscription keys, rate limiting, TLS 1.2</p>
                    <span class="badge badge-network">Gateway Pattern</span>
                </div>
                <div class="card">
                    <h4>6. AGIC Management</h4>
                    <p><strong>Path:</strong> AKS AGIC Addon ‚Üí Azure ARM API ‚Üí Application Gateway Configuration</p>
                    <p><strong>Security:</strong> Managed identity authentication, RBAC permissions</p>
                    <span class="badge badge-compute">Control Plane</span>
                </div>
            </div>

            <!-- 3.2 Network Security -->
            <h3 id="network-security">3.2 Network Security Groups</h3>
            
            <button class="collapsible">Workload NSG Rules</button>
            <div class="collapsible-content">
                <h4>Inbound Rules</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Priority</th>
                            <th>Name</th>
                            <th>Source</th>
                            <th>Port</th>
                            <th>Protocol</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>100</td>
                            <td>AllowHttpsInbound</td>
                            <td>Internet</td>
                            <td>443</td>
                            <td>TCP</td>
                            <td>Allow</td>
                        </tr>
                        <tr>
                            <td>110</td>
                            <td>AllowHttpInbound</td>
                            <td>Internet</td>
                            <td>80</td>
                            <td>TCP</td>
                            <td>Allow</td>
                        </tr>
                        <tr>
                            <td>120</td>
                            <td>AllowSshFromVNet</td>
                            <td>VirtualNetwork</td>
                            <td>22</td>
                            <td>TCP</td>
                            <td>Allow</td>
                        </tr>
                        <tr>
                            <td>130</td>
                            <td>AllowRdpFromVNet</td>
                            <td>VirtualNetwork</td>
                            <td>3389</td>
                            <td>TCP</td>
                            <td>Allow</td>
                        </tr>
                        <tr>
                            <td>4096</td>
                            <td>DenyAllInbound</td>
                            <td>*</td>
                            <td>*</td>
                            <td>*</td>
                            <td>Deny</td>
                        </tr>
                    </tbody>
                </table>

                <h4>Outbound Rules</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Priority</th>
                            <th>Name</th>
                            <th>Destination</th>
                            <th>Port</th>
                            <th>Protocol</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>100</td>
                            <td>AllowVnetOutbound</td>
                            <td>VirtualNetwork</td>
                            <td>*</td>
                            <td>*</td>
                            <td>Allow</td>
                        </tr>
                        <tr>
                            <td>110</td>
                            <td>AllowInternetOutbound</td>
                            <td>Internet</td>
                            <td>*</td>
                            <td>*</td>
                            <td>Allow</td>
                        </tr>
                        <tr>
                            <td>120</td>
                            <td>AllowAzureCloudOutbound</td>
                            <td>AzureCloud</td>
                            <td>*</td>
                            <td>*</td>
                            <td>Allow</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <button class="collapsible">Application Gateway NSG Rules</button>
            <div class="collapsible-content">
                <h4>Inbound Rules</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Priority</th>
                            <th>Name</th>
                            <th>Source</th>
                            <th>Port</th>
                            <th>Protocol</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>100</td>
                            <td>AllowGatewayManager</td>
                            <td>GatewayManager</td>
                            <td>65200-65535</td>
                            <td>TCP</td>
                            <td>Allow</td>
                        </tr>
                        <tr>
                            <td>110</td>
                            <td>AllowAzureLoadBalancer</td>
                            <td>AzureLoadBalancer</td>
                            <td>*</td>
                            <td>*</td>
                            <td>Allow</td>
                        </tr>
                        <tr>
                            <td>120</td>
                            <td>AllowHttpsInbound</td>
                            <td>Internet</td>
                            <td>443</td>
                            <td>TCP</td>
                            <td>Allow</td>
                        </tr>
                        <tr>
                            <td>130</td>
                            <td>AllowHttpInbound</td>
                            <td>Internet</td>
                            <td>80</td>
                            <td>TCP</td>
                            <td>Allow</td>
                        </tr>
                        <tr>
                            <td>4096</td>
                            <td>DenyAllInbound</td>
                            <td>*</td>
                            <td>*</td>
                            <td>*</td>
                            <td>Deny</td>
                        </tr>
                    </tbody>
                </table>

                <h4>Outbound Rules</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Priority</th>
                            <th>Name</th>
                            <th>Destination</th>
                            <th>Port</th>
                            <th>Protocol</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>100</td>
                            <td>AllowAllOutbound</td>
                            <td>*</td>
                            <td>*</td>
                            <td>*</td>
                            <td>Allow</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- 3.3 Address Planning -->
            <h3 id="network-address">3.3 Address Space Planning</h3>
            
            <table>
                <thead>
                    <tr>
                        <th>Environment</th>
                        <th>VNet CIDR</th>
                        <th>Workload Subnet</th>
                        <th>App Gateway Subnet</th>
                        <th>AKS Service CIDR</th>
                        <th>Available IPs</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="badge badge-dev">Development</span></td>
                        <td><code>10.1.0.0/16</code></td>
                        <td><code>10.1.0.0/24</code></td>
                        <td><code>10.1.1.0/24</code></td>
                        <td><code>10.2.0.0/16</code></td>
                        <td>251 per subnet</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-prod">Production</span></td>
                        <td><code>10.0.0.0/16</code></td>
                        <td><code>10.0.0.0/24</code></td>
                        <td><code>10.0.1.0/24</code></td>
                        <td><code>10.2.0.0/16</code></td>
                        <td>251 per subnet</td>
                    </tr>
                </tbody>
            </table>

            <div class="warning-box">
                <h4>‚ö†Ô∏è Important: Network Address Isolation</h4>
                <p>The AKS Service CIDR (<code>10.2.0.0/16</code>) is separate from the VNet address space and is used exclusively for Kubernetes internal services. The AKS DNS service IP (<code>10.2.0.10</code>) must be within this range.</p>
            </div>

            <h4>Service Endpoints Enabled</h4>
            <ul>
                <li>Microsoft.AzureCosmosDB</li>
                <li>Microsoft.ServiceBus</li>
                <li>Microsoft.Sql</li>
                <li>Microsoft.Storage</li>
                <li>Microsoft.KeyVault</li>
                <li>Microsoft.ApiManagement</li>
            </ul>
        </section>

        <!-- ==================== MODULE SPECIFICATIONS ==================== -->
        <section id="modules" class="section">
            <h2>üì¶ 4. Module Specifications</h2>
            <p>Detailed specifications for each infrastructure module including parameters, configurations, and outputs.</p>
            
            <!-- 4.1 Virtual Network Module -->
            <h3 id="module-vnet">4.1 Virtual Network Module</h3>
            <span class="badge badge-network">modules/networking/vnet.bicep</span>
            
            <h4>Purpose</h4>
            <p>Creates the foundational network infrastructure including Virtual Network, two subnets (workload and Application Gateway), and associated Network Security Groups with baseline security rules.</p>
            
            <button class="collapsible">Key Parameters & Configurations</button>
            <div class="collapsible-content">
                <h4>Virtual Network Settings</h4>
                <ul>
                    <li><strong>Address Space:</strong> 10.0.0.0/16 (Prod) or 10.1.0.0/16 (Dev) - 65,536 addresses</li>
                    <li><strong>DDoS Protection:</strong> Basic (included by default)</li>
                    <li><strong>VM Protection:</strong> Disabled</li>
                </ul>
                
                <h4>Workload Subnet (10.x.0.0/24)</h4>
                <ul>
                    <li><strong>Usable IPs:</strong> 251 addresses (256 - 5 Azure reserved)</li>
                    <li><strong>Private Endpoint Policies:</strong> Disabled</li>
                    <li><strong>Service Endpoints:</strong> CosmosDB, ServiceBus, Sql, Storage, KeyVault, ApiManagement</li>
                </ul>
                
                <h4>Application Gateway Subnet (10.x.1.0/24)</h4>
                <ul>
                    <li><strong>Usable IPs:</strong> 251 addresses</li>
                    <li><strong>Dedicated:</strong> Application Gateway only</li>
                </ul>
            </div>
            
            <!-- 4.2 Application Gateway Module -->
            <h3 id="module-appgw">4.2 Application Gateway Module</h3>
            <span class="badge badge-network">modules/networking/appgateway.bicep</span>
            
            <h4>Purpose</h4>
            <p>Deploys Azure Application Gateway v2 with autoscaling, WAF capabilities (production), and AGIC integration for Kubernetes ingress management.</p>
            
            <button class="collapsible">Configuration Details</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Setting</th>
                            <th>Development</th>
                            <th>Production</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>SKU</td>
                            <td>Standard_v2</td>
                            <td>WAF_v2</td>
                        </tr>
                        <tr>
                            <td>Autoscale Min/Max</td>
                            <td>0-2 units</td>
                            <td>2-10 units</td>
                        </tr>
                        <tr>
                            <td>WAF Enabled</td>
                            <td>false</td>
                            <td>true</td>
                        </tr>
                        <tr>
                            <td>WAF Mode</td>
                            <td>N/A</td>
                            <td>Detection</td>
                        </tr>
                        <tr>
                            <td>WAF Rule Set</td>
                            <td>N/A</td>
                            <td>OWASP 3.2</td>
                        </tr>
                        <tr>
                            <td>HTTP/2</td>
                            <td colspan="2">Enabled</td>
                        </tr>
                        <tr>
                            <td>Request Timeout</td>
                            <td colspan="2">30 seconds</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- 4.3 AKS Module -->
            <h3 id="module-aks">4.3 Azure Kubernetes Service Module</h3>
            <span class="badge badge-compute">modules/compute/aks.bicep</span>
            
            <h4>Purpose</h4>
            <p>Deploys a managed Kubernetes cluster with Azure CNI networking, AGIC addon for Application Gateway integration, autoscaling node pools, and optional Azure Monitor integration.</p>
            
            <button class="collapsible">Cluster Configuration</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Configuration</th>
                            <th>Development</th>
                            <th>Production</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Kubernetes Version</td>
                            <td colspan="2">1.29.0</td>
                        </tr>
                        <tr>
                            <td>SKU Tier</td>
                            <td>Free</td>
                            <td>Standard (99.9% SLA)</td>
                        </tr>
                        <tr>
                            <td>Node VM Size</td>
                            <td>Standard_D2s_v3<br/>(2 vCPU, 8 GB RAM)</td>
                            <td>Standard_D4s_v3<br/>(4 vCPU, 16 GB RAM)</td>
                        </tr>
                        <tr>
                            <td>Initial Node Count</td>
                            <td>2</td>
                            <td>3</td>
                        </tr>
                        <tr>
                            <td>Autoscale Range</td>
                            <td>1-3 nodes</td>
                            <td>3-10 nodes</td>
                        </tr>
                        <tr>
                            <td>Network Plugin</td>
                            <td colspan="2">Azure CNI</td>
                        </tr>
                        <tr>
                            <td>Service CIDR</td>
                            <td colspan="2">10.2.0.0/16</td>
                        </tr>
                        <tr>
                            <td>DNS Service IP</td>
                            <td colspan="2">10.2.0.10</td>
                        </tr>
                        <tr>
                            <td>AGIC Addon</td>
                            <td colspan="2">Enabled</td>
                        </tr>
                        <tr>
                            <td>Azure Monitor</td>
                            <td>Disabled</td>
                            <td>Enabled</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- 4.4 Cosmos DB Module -->
            <h3 id="module-cosmos">4.4 Cosmos DB Module</h3>
            <span class="badge badge-data">modules/database/cosmosdb.bicep</span>
            
            <h4>Purpose</h4>
            <p>Deploys Azure Cosmos DB account with NoSQL (SQL) API in serverless capacity mode, creates databases and containers with partition keys, and configures private endpoint for secure connectivity.</p>
            
            <button class="collapsible">Containers Configuration</button>
            <div class="collapsible-content">
                <h4>Development Environment</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Container</th>
                            <th>Partition Key</th>
                            <th>Key Version</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>products</td>
                            <td>/category</td>
                            <td>2 (Hierarchical)</td>
                        </tr>
                        <tr>
                            <td>users</td>
                            <td>/userId</td>
                            <td>2 (Hierarchical)</td>
                        </tr>
                    </tbody>
                </table>
                
                <h4>Production Environment (Additional)</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Container</th>
                            <th>Partition Key</th>
                            <th>Key Version</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>orders</td>
                            <td>/customerId</td>
                            <td>2 (Hierarchical)</td>
                        </tr>
                    </tbody>
                </table>
                
                <h4>Security Settings</h4>
                <ul>
                    <li><strong>Capacity Mode:</strong> Serverless (pay-per-request)</li>
                    <li><strong>Consistency Level:</strong> Session</li>
                    <li><strong>TLS Version:</strong> 1.2</li>
                    <li><strong>Local Authentication:</strong> Disabled</li>
                    <li><strong>Public Access:</strong> Disabled (private endpoint)</li>
                    <li><strong>Backup:</strong> Continuous (30-day restore)</li>
                </ul>
            </div>
            
            <!-- 4.5 SQL Server Module -->
            <h3 id="module-sql">4.5 SQL Server Module</h3>
            <span class="badge badge-data">modules/database/sqlserver.bicep</span>
            
            <h4>Purpose</h4>
            <p>Deploys Azure SQL Server logical server with multiple databases, configures Transparent Data Encryption (TDE), sets up private endpoint, and optionally enables Microsoft Entra ID authentication.</p>
            
            <button class="collapsible">Databases Configuration</button>
            <div class="collapsible-content">
                <h4>Development Environment</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Database</th>
                            <th>SKU</th>
                            <th>vCores</th>
                            <th>Max Size</th>
                            <th>Backup</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>CWDB</td>
                            <td>GP_Gen5_2</td>
                            <td>2</td>
                            <td>32 GB</td>
                            <td>7 days, Local</td>
                        </tr>
                        <tr>
                            <td>CW-Utility</td>
                            <td>GP_Gen5_2</td>
                            <td>2</td>
                            <td>32 GB</td>
                            <td>7 days, Local</td>
                        </tr>
                        <tr>
                            <td>sql01-nonprd-emea-db</td>
                            <td>GP_Gen5_2</td>
                            <td>2</td>
                            <td>32 GB</td>
                            <td>7 days, Local</td>
                        </tr>
                    </tbody>
                </table>
                
                <h4>Production Environment</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Database</th>
                            <th>SKU</th>
                            <th>vCores</th>
                            <th>Max Size</th>
                            <th>Backup</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>CWDB</td>
                            <td>GP_Gen5_2</td>
                            <td>2</td>
                            <td>100 GB</td>
                            <td>35 days, Geo</td>
                        </tr>
                        <tr>
                            <td>CW-Utility</td>
                            <td>GP_Gen5_2</td>
                            <td>2</td>
                            <td>50 GB</td>
                            <td>35 days, Geo</td>
                        </tr>
                        <tr>
                            <td>sql01-nonprd-emea-db</td>
                            <td>GP_Gen5_2</td>
                            <td>2</td>
                            <td>100 GB</td>
                            <td>35 days, Geo</td>
                        </tr>
                    </tbody>
                </table>
                
                <h4>Security Features</h4>
                <ul>
                    <li><strong>TDE:</strong> Enabled on all databases</li>
                    <li><strong>TLS Version:</strong> 1.2</li>
                    <li><strong>Public Access:</strong> Disabled</li>
                    <li><strong>Private Endpoint:</strong> Enabled</li>
                </ul>
            </div>
            
            <!-- 4.6 Service Bus Module -->
            <h3 id="module-servicebus">4.6 Service Bus Module</h3>
            <span class="badge badge-data">modules/messaging/servicebus.bicep</span>
            
            <h4>Purpose</h4>
            <p>Deploys Azure Service Bus namespace with Standard tier, creates queues and topics with subscriptions for reliable asynchronous messaging patterns.</p>
            
            <button class="collapsible">Messaging Resources</button>
            <div class="collapsible-content">
                <h4>Queues</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Queue</th>
                            <th>Size</th>
                            <th>Max Delivery</th>
                            <th>Lock Duration</th>
                            <th>Features</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>orders</td>
                            <td>1-2 GB</td>
                            <td>10</td>
                            <td>1 min</td>
                            <td>Dead Letter, TTL 14d</td>
                        </tr>
                        <tr>
                            <td>notifications</td>
                            <td>1 GB</td>
                            <td>5</td>
                            <td>30 sec</td>
                            <td>TTL 14d</td>
                        </tr>
                        <tr>
                            <td>payments (Prod)</td>
                            <td>2 GB</td>
                            <td>3</td>
                            <td>2 min</td>
                            <td>Duplicate Detection</td>
                        </tr>
                    </tbody>
                </table>
                
                <h4>Topics</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Topic</th>
                            <th>Size</th>
                            <th>Subscriptions</th>
                            <th>Features</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>events</td>
                            <td>1-2 GB</td>
                            <td>all-events</td>
                            <td>Ordering Enabled</td>
                        </tr>
                        <tr>
                            <td>audit (Prod)</td>
                            <td>2 GB</td>
                            <td>audit-processor</td>
                            <td>Duplicate Detection</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- 4.7 APIM Module -->
            <h3 id="module-apim">4.7 API Management Module</h3>
            <span class="badge badge-network">modules/integration/apim.bicep</span>
            
            <h4>Purpose</h4>
            <p>Deploys Azure API Management service with VNet integration (External mode), built-in APIs, products, and security policies for API gateway functionality.</p>
            
            <button class="collapsible">Service Configuration</button>
            <div class="collapsible-content">
                <ul>
                    <li><strong>SKU:</strong> Developer (1 unit, 99.95% SLA)</li>
                    <li><strong>VNet Type:</strong> External (accessible from internet)</li>
                    <li><strong>TLS Protocols:</strong> TLS 1.2 only</li>
                    <li><strong>HTTP/2:</strong> Enabled</li>
                    <li><strong>Built-in APIs:</strong> Echo API at /echo</li>
                    <li><strong>Products:</strong> Starter (public), Unlimited (approval required)</li>
                    <li><strong>Global Policy:</strong> Removes X-Powered-By headers</li>
                </ul>
            </div>
        </section>

        <!-- ==================== SECURITY CONFIGURATION ==================== -->
        <section id="security" class="section">
            <h2>üîí 5. Security Configuration</h2>
            <p>Comprehensive security settings and controls implementing defense-in-depth strategy across all infrastructure layers.</p>
            
            <h3>Security Layers Overview</h3>
            <div class="card-grid">
                <div class="card">
                    <h4>Network Security</h4>
                    <p>NSG rules, private endpoints, service endpoints, and traffic segmentation</p>
                    <span class="badge badge-network">Perimeter</span>
                </div>
                <div class="card">
                    <h4>Identity & Access</h4>
                    <p>Managed identities, RBAC, and Entra ID integration</p>
                    <span class="badge badge-data">Authentication</span>
                </div>
                <div class="card">
                    <h4>Data Protection</h4>
                    <p>Encryption at rest (TDE), encryption in transit (TLS 1.2)</p>
                    <span class="badge badge-data">Encryption</span>
                </div>
                <div class="card">
                    <h4>Application Security</h4>
                    <p>WAF rules, API policies, and input validation</p>
                    <span class="badge badge-network">Application</span>
                </div>
            </div>

            <h3>Network Security Controls</h3>
            
            <h4>Private Connectivity</h4>
            <table>
                <thead>
                    <tr>
                        <th>Resource</th>
                        <th>Connectivity Type</th>
                        <th>Public Access</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Cosmos DB</td>
                        <td>Private Endpoint</td>
                        <td>Disabled</td>
                        <td><span class="status-badge status-deployed">Enabled</span></td>
                    </tr>
                    <tr>
                        <td>SQL Server</td>
                        <td>Private Endpoint</td>
                        <td>Disabled</td>
                        <td><span class="status-badge status-deployed">Enabled</span></td>
                    </tr>
                    <tr>
                        <td>Service Bus (Standard)</td>
                        <td>Service Endpoint</td>
                        <td>Enabled (restricted)</td>
                        <td><span class="status-badge status-deployed">Enabled</span></td>
                    </tr>
                    <tr>
                        <td>Service Bus (Premium)</td>
                        <td>Private Endpoint</td>
                        <td>Disabled</td>
                        <td><span class="status-badge status-optional">Optional</span></td>
                    </tr>
                    <tr>
                        <td>AKS API Server</td>
                        <td>Public</td>
                        <td>Enabled (authorized IPs possible)</td>
                        <td><span class="status-badge status-deployed">Public</span></td>
                    </tr>
                    <tr>
                        <td>API Management</td>
                        <td>External VNet</td>
                        <td>Enabled (VNet integrated)</td>
                        <td><span class="status-badge status-deployed">Hybrid</span></td>
                    </tr>
                </tbody>
            </table>

            <h4>TLS/SSL Configuration</h4>
            <table>
                <thead>
                    <tr>
                        <th>Resource</th>
                        <th>Minimum TLS Version</th>
                        <th>Supported Protocols</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Application Gateway</td>
                        <td>TLS 1.2</td>
                        <td>TLS 1.2, HTTP/2</td>
                    </tr>
                    <tr>
                        <td>Cosmos DB</td>
                        <td>TLS 1.2</td>
                        <td>TLS 1.2, TLS 1.3</td>
                    </tr>
                    <tr>
                        <td>SQL Server</td>
                        <td>TLS 1.2</td>
                        <td>TLS 1.2</td>
                    </tr>
                    <tr>
                        <td>Service Bus</td>
                        <td>TLS 1.2</td>
                        <td>TLS 1.2</td>
                    </tr>
                    <tr>
                        <td>API Management</td>
                        <td>TLS 1.2</td>
                        <td>TLS 1.2 (SSL 3.0, TLS 1.0/1.1 disabled)</td>
                    </tr>
                </tbody>
            </table>

            <h3>Identity and Access Management</h3>
            
            <h4>Managed Identities Deployed</h4>
            <ul>
                <li><strong>System-Assigned:</strong> AKS Cluster, Cosmos DB, SQL Server, Service Bus, API Management</li>
                <li><strong>User-Assigned:</strong> Application Gateway (for AGIC integration)</li>
                <li><strong>Workload Identity:</strong> Can be configured for AKS pods to access Azure resources</li>
            </ul>

            <h4>Authentication Methods</h4>
            <table>
                <thead>
                    <tr>
                        <th>Resource</th>
                        <th>Local Auth</th>
                        <th>Managed Identity</th>
                        <th>Entra ID</th>
                        <th>Recommended</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Cosmos DB</td>
                        <td>Disabled</td>
                        <td>‚úÖ Supported</td>
                        <td>Via RBAC</td>
                        <td>Managed Identity + RBAC</td>
                    </tr>
                    <tr>
                        <td>SQL Server</td>
                        <td>‚úÖ Enabled</td>
                        <td>‚úÖ Supported</td>
                        <td>‚úÖ Optional</td>
                        <td>Entra ID Admin</td>
                    </tr>
                    <tr>
                        <td>Service Bus</td>
                        <td>‚úÖ Enabled</td>
                        <td>‚úÖ Supported</td>
                        <td>Via RBAC</td>
                        <td>Managed Identity + RBAC</td>
                    </tr>
                    <tr>
                        <td>API Management</td>
                        <td>Subscription Keys</td>
                        <td>‚úÖ Backend Auth</td>
                        <td>OAuth 2.0</td>
                        <td>OAuth 2.0 + JWT</td>
                    </tr>
                </tbody>
            </table>

            <h3>Data Protection</h3>
            
            <button class="collapsible">Encryption Configuration</button>
            <div class="collapsible-content">
                <h4>Encryption at Rest</h4>
                <ul>
                    <li><strong>SQL Databases:</strong> Transparent Data Encryption (TDE) enabled on all databases</li>
                    <li><strong>Cosmos DB:</strong> Always encrypted (Microsoft-managed keys)</li>
                    <li><strong>Service Bus:</strong> Encrypted by default (Microsoft-managed keys)</li>
                    <li><strong>AKS:</strong> OS disks encrypted with platform-managed keys</li>
                    <li><strong>Storage:</strong> Azure Storage encryption (256-bit AES)</li>
                </ul>
                
                <h4>Encryption in Transit</h4>
                <ul>
                    <li><strong>All Resources:</strong> TLS 1.2 minimum enforced</li>
                    <li><strong>Application Gateway:</strong> SSL termination, re-encryption to backend optional</li>
                    <li><strong>Private Endpoints:</strong> Traffic encrypted within Azure backbone</li>
                </ul>
            </div>

            <h3>Application Security</h3>
            
            <button class="collapsible">Web Application Firewall (Production)</button>
            <div class="collapsible-content">
                <h4>WAF Configuration</h4>
                <ul>
                    <li><strong>Enabled:</strong> Production only (WAF_v2 SKU)</li>
                    <li><strong>Mode:</strong> Detection (recommended: change to Prevention after tuning)</li>
                    <li><strong>Rule Set:</strong> OWASP Core Rule Set 3.2</li>
                    <li><strong>Rule Set Type:</strong> Microsoft Managed</li>
                </ul>
                
                <h4>Protection Categories</h4>
                <ul>
                    <li>SQL Injection attacks</li>
                    <li>Cross-Site Scripting (XSS)</li>
                    <li>Remote File Inclusion</li>
                    <li>Protocol violations</li>
                    <li>HTTP protocol violations</li>
                    <li>Malicious user agents</li>
                    <li>Session fixation</li>
                </ul>
                
                <h4>Custom Rules (Can be added)</h4>
                <ul>
                    <li>Geo-blocking by country</li>
                    <li>IP allowlist/blocklist</li>
                    <li>Rate limiting per IP</li>
                    <li>Custom pattern matching</li>
                </ul>
            </div>

            <h3>Backup and Disaster Recovery</h3>
            
            <table>
                <thead>
                    <tr>
                        <th>Resource</th>
                        <th>Backup Type</th>
                        <th>Retention (Dev)</th>
                        <th>Retention (Prod)</th>
                        <th>Redundancy</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Cosmos DB</td>
                        <td>Continuous</td>
                        <td>30 days</td>
                        <td>30 days</td>
                        <td>Automatic</td>
                    </tr>
                    <tr>
                        <td>SQL Databases</td>
                        <td>Automated</td>
                        <td>7 days</td>
                        <td>35 days</td>
                        <td>Local / Geo</td>
                    </tr>
                    <tr>
                        <td>Service Bus</td>
                        <td>None (messages)</td>
                        <td>-</td>
                        <td>-</td>
                        <td>Replay from source</td>
                    </tr>
                    <tr>
                        <td>AKS</td>
                        <td>GitOps recommended</td>
                        <td>-</td>
                        <td>-</td>
                        <td>Infrastructure as Code</td>
                    </tr>
                </tbody>
            </table>

            <div class="warning-box">
                <h4>‚ö†Ô∏è Security Best Practices Not Implemented</h4>
                <p>The following security enhancements are recommended but not included in this template:</p>
                <ul>
                    <li><strong>Azure Key Vault:</strong> For secrets, certificates, and connection string management</li>
                    <li><strong>Private DNS Zones:</strong> For proper DNS resolution of private endpoints</li>
                    <li><strong>Azure Firewall:</strong> For centralized egress filtering and control</li>
                    <li><strong>Azure Bastion:</strong> For secure RDP/SSH access without public IPs</li>
                    <li><strong>DDoS Protection Standard:</strong> Enhanced DDoS protection (Basic is included)</li>
                    <li><strong>Customer-Managed Keys:</strong> For encryption (currently using Microsoft-managed keys)</li>
                    <li><strong>Azure Policy:</strong> For governance and compliance enforcement</li>
                    <li><strong>Microsoft Defender for Cloud:</strong> Advanced threat protection</li>
                </ul>
            </div>
        </section>

        <!-- ==================== RESOURCE DEPENDENCIES ==================== -->
        <section id="dependencies" class="section">
            <h2>üîó 6. Resource Dependencies</h2>
            <p>Understanding resource dependencies is critical for proper deployment sequencing and troubleshooting. This section details the dependencies between resources and their integration points.</p>
            
            <h3>Deployment Dependency Diagram</h3>
            <div class="diagram-container">
                <p style="margin-bottom: 20px; color: var(--text-secondary);">This diagram shows the deployment order and dependencies. Resources higher in the diagram must be deployed before resources below them.</p>
                <div class="mermaid">
                    graph TD
                        Sub[Azure Subscription]
                        
                        Sub --> RG[Resource Group]
                        
                        RG --> VNet[Virtual Network]
                        
                        VNet --> Subnet1[Workload Subnet]
                        VNet --> Subnet2[App Gateway Subnet]
                        
                        Subnet1 --> NSG1[Workload NSG]
                        Subnet2 --> NSG2[App Gateway NSG]
                        
                        Subnet2 --> PIP[Public IP]
                        
                        PIP --> UAMI[User-Assigned Identity]
                        Subnet2 --> UAMI
                        
                        UAMI --> AppGW[Application Gateway]
                        NSG2 --> AppGW
                        
                        Subnet1 --> Cosmos[Cosmos DB Account]
                        Cosmos --> CosmosDB[Cosmos DB Database]
                        CosmosDB --> Containers[Cosmos Containers]
                        
                        Subnet1 --> SQLServer[SQL Server]
                        SQLServer --> Databases[SQL Databases]
                        
                        Subnet1 --> ServiceBus[Service Bus Namespace]
                        ServiceBus --> Queues[Queues]
                        ServiceBus --> Topics[Topics]
                        Topics --> Subscriptions[Topic Subscriptions]
                        
                        Subnet1 --> APIM[API Management]
                        NSG1 --> APIM
                        
                        Subnet1 --> AKS[AKS Cluster]
                        AppGW --> AKS
                        NSG1 --> AKS
                        
                        AKS --> NodeRG[Node Resource Group]
                        
                        Cosmos --> PE_Cosmos[Private Endpoint Cosmos]
                        Subnet1 --> PE_Cosmos
                        
                        SQLServer --> PE_SQL[Private Endpoint SQL]
                        Subnet1 --> PE_SQL
                        
                        ServiceBus -.-> PE_SB[Private Endpoint SB]
                        Subnet1 -.-> PE_SB
                        
                        classDef foundation fill:#e3f2fd,stroke:#0078d4,stroke-width:2px
                        classDef network fill:#bbdefb,stroke:#1976d2,stroke-width:2px
                        classDef compute fill:#fff3e0,stroke:#ff8c00,stroke-width:2px
                        classDef data fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
                        classDef security fill:#ffebee,stroke:#c62828,stroke-width:2px
                        
                        class Sub,RG foundation
                        class VNet,Subnet1,Subnet2,NSG1,NSG2,PIP network
                        class AppGW,AKS,NodeRG,APIM compute
                        class Cosmos,CosmosDB,Containers,SQLServer,Databases,ServiceBus,Queues,Topics,Subscriptions data
                        class UAMI,PE_Cosmos,PE_SQL,PE_SB security
                </div>
            </div>
            
            <h3>Deployment Phases</h3>
            <div class="card-grid">
                <div class="card">
                    <h4>Phase 1: Foundation</h4>
                    <p><strong>Resources:</strong> Subscription, Resource Group</p>
                    <p><strong>Dependencies:</strong> None</p>
                    <p><strong>Purpose:</strong> Establish the deployment scope and logical container for all resources</p>
                    <span class="badge badge-network">Foundation</span>
                </div>
                <div class="card">
                    <h4>Phase 2: Core Network</h4>
                    <p><strong>Resources:</strong> Virtual Network, Subnets, NSGs</p>
                    <p><strong>Dependencies:</strong> Resource Group</p>
                    <p><strong>Purpose:</strong> Create network foundation with security boundaries</p>
                    <span class="badge badge-network">Networking</span>
                </div>
                <div class="card">
                    <h4>Phase 3: Gateway Prerequisites</h4>
                    <p><strong>Resources:</strong> Public IP, User-Assigned Identity</p>
                    <p><strong>Dependencies:</strong> Subnets</p>
                    <p><strong>Purpose:</strong> Prepare resources required by Application Gateway</p>
                    <span class="badge badge-network">Prerequisites</span>
                </div>
                <div class="card">
                    <h4>Phase 4: Data Services</h4>
                    <p><strong>Resources:</strong> Cosmos DB, SQL Server, Service Bus</p>
                    <p><strong>Dependencies:</strong> Workload Subnet (service endpoints)</p>
                    <p><strong>Purpose:</strong> Deploy data and messaging infrastructure</p>
                    <span class="badge badge-data">Data Layer</span>
                </div>
                <div class="card">
                    <h4>Phase 5: Gateway</h4>
                    <p><strong>Resources:</strong> Application Gateway</p>
                    <p><strong>Dependencies:</strong> Public IP, App Gateway Subnet, User-Assigned Identity</p>
                    <p><strong>Purpose:</strong> Deploy Layer 7 load balancer</p>
                    <span class="badge badge-network">Gateway</span>
                </div>
                <div class="card">
                    <h4>Phase 6: Compute</h4>
                    <p><strong>Resources:</strong> AKS Cluster with AGIC, API Management</p>
                    <p><strong>Dependencies:</strong> Workload Subnet, Application Gateway</p>
                    <p><strong>Purpose:</strong> Deploy workload execution platform</p>
                    <span class="badge badge-compute">Compute</span>
                </div>
                <div class="card">
                    <h4>Phase 7: Private Connectivity</h4>
                    <p><strong>Resources:</strong> Private Endpoints</p>
                    <p><strong>Dependencies:</strong> Data services, Workload Subnet</p>
                    <p><strong>Purpose:</strong> Establish secure private connectivity</p>
                    <span class="badge badge-data">Security</span>
                </div>
                <div class="card">
                    <h4>Phase 8: Data Assets</h4>
                    <p><strong>Resources:</strong> Cosmos Containers, SQL Databases, SB Queues/Topics</p>
                    <p><strong>Dependencies:</strong> Parent data services</p>
                    <p><strong>Purpose:</strong> Create application data structures</p>
                    <span class="badge badge-data">Data Assets</span>
                </div>
            </div>
            
            <h3>Key Integration Points</h3>
            
            <button class="collapsible">Application Gateway ‚Üî AKS Integration</button>
            <div class="collapsible-content">
                <h4>AGIC (Application Gateway Ingress Controller)</h4>
                <p>The AKS cluster uses the AGIC addon to dynamically manage Application Gateway configuration based on Kubernetes Ingress resources.</p>
                
                <h4>Integration Details</h4>
                <ul>
                    <li><strong>Method:</strong> AKS addon (ingress-appgw)</li>
                    <li><strong>Identity:</strong> User-assigned managed identity shared between App Gateway and AGIC</li>
                    <li><strong>Permissions:</strong> AGIC identity has Contributor role on Application Gateway</li>
                    <li><strong>Backend Pool:</strong> AGIC automatically adds/removes AKS nodes to App Gateway backend pool</li>
                    <li><strong>Health Probes:</strong> AGIC configures health probes based on Kubernetes readiness probes</li>
                    <li><strong>Routing Rules:</strong> Kubernetes Ingress objects translate to App Gateway routing rules</li>
                </ul>
                
                <h4>Traffic Flow</h4>
                <ol>
                    <li>Developer creates Kubernetes Ingress resource</li>
                    <li>AGIC addon watches for Ingress changes</li>
                    <li>AGIC calls Azure ARM API to update Application Gateway configuration</li>
                    <li>Application Gateway routes traffic to AKS node IPs</li>
                    <li>Kubernetes Service routes to appropriate pods</li>
                </ol>
                
                <div class="warning-box">
                    <h4>‚ö†Ô∏è Important Dependency</h4>
                    <p>Application Gateway must be deployed before AKS cluster because the AGIC addon requires the Application Gateway resource ID during AKS cluster creation.</p>
                </div>
            </div>
            
            <button class="collapsible">AKS ‚Üî Cosmos DB Integration</button>
            <div class="collapsible-content">
                <h4>Connection Method</h4>
                <p>AKS workloads connect to Cosmos DB through Private Endpoint, ensuring traffic never traverses the public internet.</p>
                
                <h4>Integration Details</h4>
                <ul>
                    <li><strong>Connectivity:</strong> Private Endpoint in workload subnet</li>
                    <li><strong>DNS Resolution:</strong> Private endpoint creates DNS record (cosmos-webapp.privatelink.documents.azure.com)</li>
                    <li><strong>Endpoint:</strong> https://cosmos-webapp-*.documents.azure.com</li>
                    <li><strong>Authentication:</strong> 
                        <ul>
                            <li>Managed Identity (recommended - requires RBAC role assignment)</li>
                            <li>Connection string stored in Kubernetes Secrets</li>
                        </ul>
                    </li>
                    <li><strong>SDK:</strong> Azure Cosmos DB SDK for .NET, Java, Python, or Node.js</li>
                    <li><strong>Consistency:</strong> Session consistency (default)</li>
                </ul>
                
                <h4>Required Configuration</h4>
                <pre><code># Kubernetes Secret Example
apiVersion: v1
kind: Secret
metadata:
  name: cosmos-connection
type: Opaque
stringData:
  endpoint: https://cosmos-webapp-*.documents.azure.com:443/
  key: [Primary Key or use Managed Identity]
  database: appdb-dev</code></pre>
            </div>
            
            <button class="collapsible">AKS ‚Üî SQL Server Integration</button>
            <div class="collapsible-content">
                <h4>Connection Method</h4>
                <p>AKS workloads connect to Azure SQL Server through Private Endpoint with encrypted connections.</p>
                
                <h4>Integration Details</h4>
                <ul>
                    <li><strong>Connectivity:</strong> Private Endpoint in workload subnet</li>
                    <li><strong>DNS Resolution:</strong> sql-webapp-*.privatelink.database.windows.net</li>
                    <li><strong>Port:</strong> 1433 (default SQL port)</li>
                    <li><strong>Encryption:</strong> TLS 1.2 enforced</li>
                    <li><strong>Authentication Methods:</strong>
                        <ul>
                            <li>SQL Authentication (username/password in Kubernetes Secrets)</li>
                            <li>Managed Identity (recommended - requires Entra ID admin configuration)</li>
                        </ul>
                    </li>
                    <li><strong>Connection String Format:</strong></li>
                </ul>
                
                <pre><code>Server=tcp:sql-webapp-*.database.windows.net,1433;
Database=CWDB;
User ID=sqladmin;
Password={your_password};
Encrypt=True;
TrustServerCertificate=False;
Connection Timeout=30;</code></pre>
                
                <h4>High Availability</h4>
                <ul>
                    <li><strong>General Purpose Tier:</strong> 99.99% SLA</li>
                    <li><strong>Geo-Replication:</strong> Configured in production (backup redundancy)</li>
                    <li><strong>Automatic Backups:</strong> 7 days (dev), 35 days (prod)</li>
                    <li><strong>Connection Pooling:</strong> Recommended in application code</li>
                </ul>
            </div>
            
            <button class="collapsible">AKS ‚Üî Service Bus Integration</button>
            <div class="collapsible-content">
                <h4>Connection Method</h4>
                <p>AKS workloads connect to Service Bus through Service Endpoints (Standard tier) or Private Endpoint (Premium tier).</p>
                
                <h4>Integration Details</h4>
                <ul>
                    <li><strong>Connectivity (Standard):</strong> Service Endpoint - traffic stays on Azure backbone</li>
                    <li><strong>Connectivity (Premium):</strong> Private Endpoint - traffic stays within VNet</li>
                    <li><strong>Endpoint:</strong> https://sb-webapp-*.servicebus.windows.net</li>
                    <li><strong>Protocols:</strong> AMQP, AMQP over WebSockets, HTTPS</li>
                    <li><strong>Authentication:</strong>
                        <ul>
                            <li>Shared Access Signature (SAS) tokens</li>
                            <li>Managed Identity (recommended)</li>
                        </ul>
                    </li>
                </ul>
                
                <h4>Messaging Patterns</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Pattern</th>
                            <th>Service Bus Feature</th>
                            <th>Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Point-to-Point</td>
                            <td>Queues</td>
                            <td>Order processing, background jobs</td>
                        </tr>
                        <tr>
                            <td>Publish-Subscribe</td>
                            <td>Topics + Subscriptions</td>
                            <td>Event broadcasting, audit logging</td>
                        </tr>
                        <tr>
                            <td>Dead Letter Queue</td>
                            <td>DLQ (automatic)</td>
                            <td>Failed message handling</td>
                        </tr>
                        <tr>
                            <td>Scheduled Messages</td>
                            <td>Message scheduling</td>
                            <td>Delayed processing</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <button class="collapsible">API Management ‚Üî AKS Integration</button>
            <div class="collapsible-content">
                <h4>Integration Architecture</h4>
                <p>API Management is deployed in External VNet mode, allowing it to receive traffic from the internet while accessing AKS services through the workload subnet.</p>
                
                <h4>Integration Details</h4>
                <ul>
                    <li><strong>VNet Integration:</strong> APIM deployed in workload subnet (External mode)</li>
                    <li><strong>Backend Configuration:</strong> APIM backend URLs point to AKS service endpoints or ingress</li>
                    <li><strong>Service Discovery:</strong> Manual configuration or DNS-based</li>
                    <li><strong>Load Balancing:</strong> APIM can load balance across multiple AKS backend instances</li>
                </ul>
                
                <h4>API Gateway Features</h4>
                <ul>
                    <li><strong>Authentication:</strong> API keys, OAuth 2.0, JWT validation</li>
                    <li><strong>Rate Limiting:</strong> Quota policies per subscription</li>
                    <li><strong>Transformation:</strong> Request/response modification</li>
                    <li><strong>Caching:</strong> Response caching for performance</li>
                    <li><strong>Monitoring:</strong> Built-in analytics and logging</li>
                </ul>
                
                <h4>Typical Flow</h4>
                <ol>
                    <li>External client calls APIM endpoint: https://apim-webapp-*.azure-api.net/api/resource</li>
                    <li>APIM validates subscription key and applies policies</li>
                    <li>APIM forwards request to AKS backend: http://service-name.namespace.svc.cluster.local</li>
                    <li>AKS service processes request and returns response</li>
                    <li>APIM applies response policies and returns to client</li>
                </ol>
            </div>
            
            <h3>Managed Identity Permissions</h3>
            <div class="info-box">
                <h4>‚ÑπÔ∏è Identity-Based Access Control</h4>
                <p>The infrastructure uses managed identities to eliminate the need for storing credentials. The following table shows required role assignments:</p>
            </div>
            
            <table>
                <thead>
                    <tr>
                        <th>Identity</th>
                        <th>Type</th>
                        <th>Target Resource</th>
                        <th>Required Role</th>
                        <th>Purpose</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Application Gateway</td>
                        <td>User-Assigned</td>
                        <td>Self</td>
                        <td>-</td>
                        <td>Identity for AGIC integration</td>
                    </tr>
                    <tr>
                        <td>AGIC Addon</td>
                        <td>System-Assigned</td>
                        <td>Application Gateway</td>
                        <td>Contributor</td>
                        <td>Update App Gateway configuration</td>
                    </tr>
                    <tr>
                        <td>AGIC Addon</td>
                        <td>System-Assigned</td>
                        <td>Resource Group</td>
                        <td>Reader</td>
                        <td>Read resource information</td>
                    </tr>
                    <tr>
                        <td>AKS Cluster</td>
                        <td>System-Assigned</td>
                        <td>Virtual Network</td>
                        <td>Network Contributor</td>
                        <td>Create load balancers, public IPs</td>
                    </tr>
                    <tr>
                        <td>AKS Cluster</td>
                        <td>System-Assigned</td>
                        <td>Node Resource Group</td>
                        <td>Contributor</td>
                        <td>Manage node resources (VMSS, disks)</td>
                    </tr>
                    <tr>
                        <td>Cosmos DB</td>
                        <td>System-Assigned</td>
                        <td>-</td>
                        <td>-</td>
                        <td>For future RBAC data plane access</td>
                    </tr>
                    <tr>
                        <td>SQL Server</td>
                        <td>System-Assigned</td>
                        <td>-</td>
                        <td>-</td>
                        <td>For Entra ID authentication</td>
                    </tr>
                    <tr>
                        <td>Service Bus</td>
                        <td>System-Assigned</td>
                        <td>-</td>
                        <td>-</td>
                        <td>For keyless authentication</td>
                    </tr>
                    <tr>
                        <td>API Management</td>
                        <td>System-Assigned</td>
                        <td>-</td>
                        <td>-</td>
                        <td>For backend authentication</td>
                    </tr>
                    <tr>
                        <td>App Workload</td>
                        <td>Workload Identity</td>
                        <td>Cosmos DB</td>
                        <td>Cosmos DB Data Contributor</td>
                        <td>Read/write data</td>
                    </tr>
                    <tr>
                        <td>App Workload</td>
                        <td>Workload Identity</td>
                        <td>Service Bus</td>
                        <td>Azure Service Bus Data Sender/Receiver</td>
                        <td>Send/receive messages</td>
                    </tr>
                </tbody>
            </table>
            
            <h3>Network Dependencies</h3>
            
            <h4>Subnet Delegation and Constraints</h4>
            <table>
                <thead>
                    <tr>
                        <th>Subnet</th>
                        <th>Resources</th>
                        <th>Constraints</th>
                        <th>Requirements</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Workload Subnet</td>
                        <td>AKS nodes, Private Endpoints, APIM</td>
                        <td>Cannot be delegated to multiple services</td>
                        <td>Service endpoints enabled, /24 minimum for AKS</td>
                    </tr>
                    <tr>
                        <td>App Gateway Subnet</td>
                        <td>Application Gateway only</td>
                        <td>Must be dedicated to App Gateway</td>
                        <td>/24 minimum recommended for v2 SKU</td>
                    </tr>
                </tbody>
            </table>
            
            <h4>Port Requirements</h4>
            <table>
                <thead>
                    <tr>
                        <th>Source</th>
                        <th>Destination</th>
                        <th>Port</th>
                        <th>Protocol</th>
                        <th>Purpose</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Internet</td>
                        <td>App Gateway</td>
                        <td>443, 80</td>
                        <td>TCP</td>
                        <td>HTTPS/HTTP application traffic</td>
                    </tr>
                    <tr>
                        <td>GatewayManager</td>
                        <td>App Gateway</td>
                        <td>65200-65535</td>
                        <td>TCP</td>
                        <td>Control plane management</td>
                    </tr>
                    <tr>
                        <td>App Gateway</td>
                        <td>AKS Nodes</td>
                        <td>Dynamic</td>
                        <td>TCP</td>
                        <td>Backend pool traffic (NodePort)</td>
                    </tr>
                    <tr>
                        <td>AKS Pods</td>
                        <td>Cosmos DB</td>
                        <td>443</td>
                        <td>TCP</td>
                        <td>HTTPS API calls</td>
                    </tr>
                    <tr>
                        <td>AKS Pods</td>
                        <td>SQL Server</td>
                        <td>1433</td>
                        <td>TCP</td>
                        <td>SQL connections</td>
                    </tr>
                    <tr>
                        <td>AKS Pods</td>
                        <td>Service Bus</td>
                        <td>443, 5671, 5672</td>
                        <td>TCP</td>
                        <td>HTTPS, AMQP, AMQP/WS</td>
                    </tr>
                    <tr>
                        <td>AKS Nodes</td>
                        <td>AKS API Server</td>
                        <td>443</td>
                        <td>TCP</td>
                        <td>Kubernetes API</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="warning-box">
                <h4>‚ö†Ô∏è Critical Dependencies for Production</h4>
                <ul>
                    <li><strong>Log Analytics Workspace:</strong> Must be created before enabling diagnostics and AKS monitoring</li>
                    <li><strong>DNS Resolution:</strong> Private DNS zones recommended for private endpoints (not deployed in this template)</li>
                    <li><strong>Container Registry:</strong> Required for AKS deployments (not included in this infrastructure)</li>
                    <li><strong>Key Vault:</strong> Recommended for storing secrets, connection strings, and certificates (not deployed)</li>
                </ul>
            </div>
        </section>

        <!-- ==================== DEPLOYMENT CONFIGURATION ==================== -->
        <section id="deployment" class="section">
            <h2>üöÄ 7. Deployment Configuration</h2>
            <p>Environment-specific deployment configurations with detailed comparisons between Development and Production environments.</p>
            
            <h3>Environment Overview</h3>
            <div class="card-grid">
                <div class="card">
                    <h4>Development Environment</h4>
                    <p><strong>Purpose:</strong> Testing, development, and experimentation</p>
                    <p><strong>SLA:</strong> None</p>
                    <p><strong>Cost:</strong> Optimized for minimal cost</p>
                    <p><strong>Network:</strong> 10.1.0.0/16</p>
                    <span class="badge badge-dev">DEV</span>
                </div>
                <div class="card">
                    <h4>Production Environment</h4>
                    <p><strong>Purpose:</strong> Live production workloads</p>
                    <p><strong>SLA:</strong> 99.9% - 99.99%</p>
                    <p><strong>Cost:</strong> Optimized for performance and reliability</p>
                    <p><strong>Network:</strong> 10.0.0.0/16</p>
                    <span class="badge badge-prod">PROD</span>
                </div>
            </div>

            <h3>Deployment Parameters Comparison</h3>
            
            <button class="collapsible">Networking Configuration</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Development</th>
                            <th>Production</th>
                            <th>Rationale</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>location</code></td>
                            <td>eastus2</td>
                            <td>eastus2</td>
                            <td>Same region for consistency</td>
                        </tr>
                        <tr>
                            <td><code>vnetAddressPrefix</code></td>
                            <td>10.1.0.0/16</td>
                            <td>10.0.0.0/16</td>
                            <td>Separate address spaces prevent conflicts</td>
                        </tr>
                        <tr>
                            <td><code>subnetAddressPrefix</code></td>
                            <td>10.1.0.0/24</td>
                            <td>10.0.0.0/24</td>
                            <td>251 usable IPs per subnet</td>
                        </tr>
                        <tr>
                            <td><code>appGatewaySubnetAddressPrefix</code></td>
                            <td>10.1.1.0/24</td>
                            <td>10.0.1.0/24</td>
                            <td>Dedicated subnet for App Gateway</td>
                        </tr>
                        <tr>
                            <td><code>enableDiagnostics</code></td>
                            <td>false</td>
                            <td>true</td>
                            <td>Reduce costs in dev, full monitoring in prod</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <button class="collapsible">Application Gateway Configuration</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Development</th>
                            <th>Production</th>
                            <th>Impact</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>appGatewaySku</code></td>
                            <td>Standard_v2</td>
                            <td>WAF_v2</td>
                            <td>Production has WAF protection</td>
                        </tr>
                        <tr>
                            <td><code>appGatewayMinCapacity</code></td>
                            <td>0</td>
                            <td>2</td>
                            <td>Dev can scale to zero to save costs</td>
                        </tr>
                        <tr>
                            <td><code>appGatewayMaxCapacity</code></td>
                            <td>2</td>
                            <td>10</td>
                            <td>Production handles higher traffic</td>
                        </tr>
                        <tr>
                            <td><code>enableWaf</code></td>
                            <td>false</td>
                            <td>true</td>
                            <td>OWASP 3.2 protection in production</td>
                        </tr>
                    </tbody>
                </table>
                
                <h4>Cost Implications</h4>
                <ul>
                    <li><strong>Development:</strong> ~$120-160/month (Standard_v2, 0-2 units)</li>
                    <li><strong>Production:</strong> ~$240-800/month (WAF_v2, 2-10 units)</li>
                </ul>
            </div>

            <button class="collapsible">Azure Kubernetes Service Configuration</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Development</th>
                            <th>Production</th>
                            <th>Impact</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>aksSku</code></td>
                            <td>Free</td>
                            <td>Standard</td>
                            <td>Standard provides 99.9% SLA</td>
                        </tr>
                        <tr>
                            <td><code>aksNodeVmSize</code></td>
                            <td>Standard_D2s_v3<br/>(2 vCPU, 8 GB)</td>
                            <td>Standard_D4s_v3<br/>(4 vCPU, 16 GB)</td>
                            <td>Production has 2x resources per node</td>
                        </tr>
                        <tr>
                            <td><code>aksNodeCount</code></td>
                            <td>2</td>
                            <td>3</td>
                            <td>Production starts with more capacity</td>
                        </tr>
                        <tr>
                            <td><code>aksMinNodeCount</code></td>
                            <td>1</td>
                            <td>3</td>
                            <td>Production maintains minimum 3 nodes</td>
                        </tr>
                        <tr>
                            <td><code>aksMaxNodeCount</code></td>
                            <td>3</td>
                            <td>10</td>
                            <td>Production can scale higher</td>
                        </tr>
                        <tr>
                            <td><code>enableAksMonitoring</code></td>
                            <td>false</td>
                            <td>true</td>
                            <td>Azure Monitor Container Insights</td>
                        </tr>
                        <tr>
                            <td><code>kubernetesVersion</code></td>
                            <td>1.29.0</td>
                            <td>1.29.0</td>
                            <td>Same version for consistency</td>
                        </tr>
                    </tbody>
                </table>
                
                <h4>Cost Implications</h4>
                <ul>
                    <li><strong>Development:</strong> ~$150-300/month (Free tier, 1-3 x D2s_v3 nodes)</li>
                    <li><strong>Production:</strong> ~$73/month (Standard tier) + ~$450-1500/month (3-10 x D4s_v3 nodes)</li>
                </ul>
            </div>

            <button class="collapsible">Cosmos DB Configuration</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Development</th>
                            <th>Production</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>cosmosDbDatabaseName</code></td>
                            <td>appdb-dev</td>
                            <td>appdb-prod</td>
                            <td>Separate databases per environment</td>
                        </tr>
                        <tr>
                            <td><code>cosmosDbContainers</code></td>
                            <td>2 containers<br/>(products, users)</td>
                            <td>3 containers<br/>(+ orders)</td>
                            <td>Production has additional containers</td>
                        </tr>
                        <tr>
                            <td><code>enableCosmosDbPrivateEndpoint</code></td>
                            <td>true</td>
                            <td>true</td>
                            <td>Both use private connectivity</td>
                        </tr>
                        <tr>
                            <td><code>enableCosmosDbFreeTier</code></td>
                            <td>false</td>
                            <td>false</td>
                            <td>Free tier: 1 per subscription</td>
                        </tr>
                        <tr>
                            <td>Capacity Mode</td>
                            <td>Serverless</td>
                            <td>Serverless</td>
                            <td>Pay-per-request pricing</td>
                        </tr>
                    </tbody>
                </table>
                
                <h4>Cost Implications</h4>
                <ul>
                    <li><strong>Serverless:</strong> $0.25/million RU/s + $0.25/GB storage per month</li>
                    <li><strong>Usage-based:</strong> Scales to zero when not in use</li>
                </ul>
            </div>

            <button class="collapsible">SQL Server Configuration</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Configuration</th>
                            <th>Development</th>
                            <th>Production</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Database Count</td>
                            <td>3 (CWDB, CW-Utility, sql01-nonprd-emea-db)</td>
                            <td>3 (same)</td>
                        </tr>
                        <tr>
                            <td>SKU per Database</td>
                            <td>GP_Gen5_2 (2 vCores)</td>
                            <td>GP_Gen5_2 (2 vCores)</td>
                        </tr>
                        <tr>
                            <td>Max Size per DB</td>
                            <td>32 GB</td>
                            <td>50-100 GB</td>
                        </tr>
                        <tr>
                            <td>Backup Retention</td>
                            <td>7 days</td>
                            <td>35 days (5 weeks)</td>
                        </tr>
                        <tr>
                            <td>Backup Redundancy</td>
                            <td>Local</td>
                            <td>Geo-redundant</td>
                        </tr>
                        <tr>
                            <td>Zone Redundancy</td>
                            <td>false</td>
                            <td>false</td>
                        </tr>
                        <tr>
                            <td>License Type</td>
                            <td>LicenseIncluded</td>
                            <td>LicenseIncluded</td>
                        </tr>
                    </tbody>
                </table>
                
                <h4>Cost Implications</h4>
                <ul>
                    <li><strong>Development:</strong> ~$465/month (3 x GP_Gen5_2 @ $155/month each)</li>
                    <li><strong>Production:</strong> ~$465/month (same compute) + additional backup storage costs</li>
                </ul>
            </div>

            <button class="collapsible">Service Bus Configuration</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Configuration</th>
                            <th>Development</th>
                            <th>Production</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>serviceBusSku</code></td>
                            <td>Standard</td>
                            <td>Standard</td>
                        </tr>
                        <tr>
                            <td>Queues</td>
                            <td>2 (orders, notifications)</td>
                            <td>3 (+ payments)</td>
                        </tr>
                        <tr>
                            <td>Topics</td>
                            <td>1 (events)</td>
                            <td>2 (+ audit)</td>
                        </tr>
                        <tr>
                            <td>Queue Sizes</td>
                            <td>1 GB</td>
                            <td>1-2 GB</td>
                        </tr>
                        <tr>
                            <td>Private Endpoint</td>
                            <td>false (requires Premium)</td>
                            <td>false (requires Premium)</td>
                        </tr>
                    </tbody>
                </table>
                
                <h4>Cost Implications</h4>
                <ul>
                    <li><strong>Standard Tier:</strong> ~$10/month base + $0.05 per million operations</li>
                    <li><strong>Premium Upgrade:</strong> ~$677/month (1 messaging unit) for private endpoint support</li>
                </ul>
            </div>

            <button class="collapsible">API Management Configuration</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Development</th>
                            <th>Production</th>
                            <th>Recommendation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>apimSku</code></td>
                            <td>Developer</td>
                            <td>Developer</td>
                            <td>Use Standard or Premium for prod</td>
                        </tr>
                        <tr>
                            <td><code>apimCapacity</code></td>
                            <td>1 unit</td>
                            <td>1 unit</td>
                            <td>Scale as needed</td>
                        </tr>
                        <tr>
                            <td><code>apimVirtualNetworkType</code></td>
                            <td>External</td>
                            <td>External</td>
                            <td>Consider Internal for prod</td>
                        </tr>
                        <tr>
                            <td><code>apimPublisherEmail</code></td>
                            <td>dev-team@contoso.com</td>
                            <td>ops-team@contoso.com</td>
                            <td>Different contact per environment</td>
                        </tr>
                    </tbody>
                </table>
                
                <h4>Cost Implications</h4>
                <ul>
                    <li><strong>Developer:</strong> ~$50/month (no SLA, dev/test only)</li>
                    <li><strong>Standard:</strong> ~$750/month (99.9% SLA, production-ready)</li>
                    <li><strong>Premium:</strong> ~$2,940/month (99.95% SLA, multi-region)</li>
                </ul>
            </div>

            <h3>Resource Tags Comparison</h3>
            <table>
                <thead>
                    <tr>
                        <th>Tag</th>
                        <th>Development</th>
                        <th>Production</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Application</td>
                        <td>WebApplication</td>
                        <td>WebApplication</td>
                    </tr>
                    <tr>
                        <td>CostCenter</td>
                        <td>IT-Development</td>
                        <td>IT-Production</td>
                    </tr>
                    <tr>
                        <td>Owner</td>
                        <td>dev-team@company.com</td>
                        <td>ops-team@company.com</td>
                    </tr>
                    <tr>
                        <td>Criticality</td>
                        <td>Low</td>
                        <td>High</td>
                    </tr>
                    <tr>
                        <td>DataClassification</td>
                        <td>Internal</td>
                        <td>Confidential</td>
                    </tr>
                    <tr>
                        <td>BusinessUnit</td>
                        <td>Engineering</td>
                        <td>Engineering</td>
                    </tr>
                    <tr>
                        <td>SLA</td>
                        <td>-</td>
                        <td>99.9</td>
                    </tr>
                    <tr>
                        <td>BackupPolicy</td>
                        <td>-</td>
                        <td>Daily</td>
                    </tr>
                </tbody>
            </table>

            <h3>Deployment Commands</h3>
            
            <h4>PowerShell Deployment</h4>
            <pre><code># Development Environment
az deployment sub create `
  --location eastus2 `
  --template-file main.bicep `
  --parameters main.dev.bicepparam `
  --name "infra-dev-$(Get-Date -Format 'yyyyMMdd-HHmmss')"

# Production Environment
az deployment sub create `
  --location eastus2 `
  --template-file main.bicep `
  --parameters main.prod.bicepparam `
  --parameters sqlServerAdminPassword='YourSecurePassword123!' `
  --name "infra-prod-$(Get-Date -Format 'yyyyMMdd-HHmmss')"</code></pre>

            <h4>Bash Deployment</h4>
            <pre><code># Development Environment
az deployment sub create \
  --location eastus2 \
  --template-file main.bicep \
  --parameters main.dev.bicepparam \
  --name "infra-dev-$(date +%Y%m%d-%H%M%S)"

# Production Environment
az deployment sub create \
  --location eastus2 \
  --template-file main.bicep \
  --parameters main.prod.bicepparam \
  --parameters sqlServerAdminPassword='YourSecurePassword123!' \
  --name "infra-prod-$(date +%Y%m%d-%H%M%S)"</code></pre>

            <h3>Estimated Monthly Costs</h3>
            <table>
                <thead>
                    <tr>
                        <th>Component</th>
                        <th>Development</th>
                        <th>Production</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Application Gateway</td>
                        <td>$120-160</td>
                        <td>$240-800</td>
                    </tr>
                    <tr>
                        <td>AKS (Cluster + Nodes)</td>
                        <td>$150-300</td>
                        <td>$523-1573</td>
                    </tr>
                    <tr>
                        <td>SQL Databases (3x)</td>
                        <td>$465</td>
                        <td>$465+</td>
                    </tr>
                    <tr>
                        <td>Cosmos DB</td>
                        <td>Usage-based</td>
                        <td>Usage-based</td>
                    </tr>
                    <tr>
                        <td>Service Bus</td>
                        <td>$10+</td>
                        <td>$10+</td>
                    </tr>
                    <tr>
                        <td>API Management</td>
                        <td>$50</td>
                        <td>$50 (upgrade to $750+)</td>
                    </tr>
                    <tr>
                        <td><strong>Total (approx)</strong></td>
                        <td><strong>$795-985/month</strong></td>
                        <td><strong>$1,288-2,898/month</strong></td>
                    </tr>
                </tbody>
            </table>

            <div class="info-box">
                <h4>‚ÑπÔ∏è Cost Optimization Tips</h4>
                <ul>
                    <li><strong>Development:</strong> Shut down or scale to minimum during non-working hours</li>
                    <li><strong>Reserved Instances:</strong> 1-year or 3-year reservations for production VMs (up to 72% savings)</li>
                    <li><strong>Azure Hybrid Benefit:</strong> Use existing SQL Server licenses (up to 55% savings)</li>
                    <li><strong>Autoscaling:</strong> Let AKS and App Gateway scale down during low traffic</li>
                    <li><strong>Spot Instances:</strong> Consider for non-critical AKS workloads (up to 90% savings)</li>
                </ul>
            </div>
        </section>

        <!-- ==================== NAMING CONVENTIONS ==================== -->
        <section id="naming" class="section">
            <h2>üè∑Ô∏è 8. Naming Conventions</h2>
            <p>Azure resource naming standards and patterns following organizational requirements with <code>CW_*_DEV</code> prefix.</p>
            
            <h3>Naming Pattern Overview</h3>
            <div class="card-grid">
                <div class="card">
                    <h4>Standard Format</h4>
                    <pre><code>CW_{RESOURCE}_{ENVIRONMENT}</code></pre>
                    <p><strong>Example:</strong> CW_AKS_DEV</p>
                    <p><strong>Components:</strong></p>
                    <ul>
                        <li><code>CW</code> - Project/Workload identifier</li>
                        <li><code>{RESOURCE}</code> - Resource type abbreviation</li>
                        <li><code>{ENVIRONMENT}</code> - DEV or PROD</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>Design Principles</h4>
                    <ul>
                        <li>‚úì Uppercase with underscores</li>
                        <li>‚úì Max 24 characters (Storage Account limit)</li>
                        <li>‚úì Descriptive abbreviations</li>
                        <li>‚úì Environment separation</li>
                        <li>‚úì Easy to identify resource type</li>
                        <li>‚úì Consistent across all resources</li>
                    </ul>
                </div>
            </div>

            <h3>Project-Specific Resource Names</h3>
            <table>
                <thead>
                    <tr>
                        <th>Resource Type</th>
                        <th>Development Name</th>
                        <th>Production Name</th>
                        <th>Azure Resource Type</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Resource Group</strong></td>
                        <td><code>CW_RG_DEV</code></td>
                        <td><code>CW_RG_PROD</code></td>
                        <td>Microsoft.Resources/resourceGroups</td>
                    </tr>
                    <tr>
                        <td><strong>AKS Cluster</strong></td>
                        <td><code>CW_AKS_DEV</code></td>
                        <td><code>CW_AKS_PROD</code></td>
                        <td>Microsoft.ContainerService/managedClusters</td>
                    </tr>
                    <tr>
                        <td><strong>SQL Server</strong></td>
                        <td><code>CW_SQLSRV_DEV</code></td>
                        <td><code>CW_SQLSRV_PROD</code></td>
                        <td>Microsoft.Sql/servers</td>
                    </tr>
                    <tr>
                        <td><strong>Service Bus</strong></td>
                        <td><code>CW_SVCBUS_DEV</code></td>
                        <td><code>CW_SVCBUS_PROD</code></td>
                        <td>Microsoft.ServiceBus/namespaces</td>
                    </tr>
                    <tr>
                        <td><strong>Cosmos DB</strong></td>
                        <td><code>CW_COSMOS_DEV</code></td>
                        <td><code>CW_COSMOS_PROD</code></td>
                        <td>Microsoft.DocumentDB/databaseAccounts</td>
                    </tr>
                    <tr>
                        <td><strong>Application Gateway</strong></td>
                        <td><code>CW_APPGW_DEV</code></td>
                        <td><code>CW_APPGW_PROD</code></td>
                        <td>Microsoft.Network/applicationGateways</td>
                    </tr>
                    <tr>
                        <td><strong>API Management</strong></td>
                        <td><code>CW_APIM_DEV</code></td>
                        <td><code>CW_APIM_PROD</code></td>
                        <td>Microsoft.ApiManagement/service</td>
                    </tr>
                </tbody>
            </table>

            <h3>Additional Infrastructure Resource Names</h3>
            
            <button class="collapsible">Networking Resources</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Resource</th>
                            <th>Development</th>
                            <th>Production</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Virtual Network</td>
                            <td><code>CW_VNET_DEV</code></td>
                            <td><code>CW_VNET_PROD</code></td>
                            <td>Main virtual network</td>
                        </tr>
                        <tr>
                            <td>Workload Subnet</td>
                            <td><code>CW_SUBNET_WORK_DEV</code></td>
                            <td><code>CW_SUBNET_WORK_PROD</code></td>
                            <td>For AKS, VMs, etc.</td>
                        </tr>
                        <tr>
                            <td>App Gateway Subnet</td>
                            <td><code>CW_SUBNET_APPGW_DEV</code></td>
                            <td><code>CW_SUBNET_APPGW_PROD</code></td>
                            <td>Dedicated for App Gateway</td>
                        </tr>
                        <tr>
                            <td>Network Security Group</td>
                            <td><code>CW_NSG_WORK_DEV</code></td>
                            <td><code>CW_NSG_WORK_PROD</code></td>
                            <td>Workload subnet NSG</td>
                        </tr>
                        <tr>
                            <td>App Gateway NSG</td>
                            <td><code>CW_NSG_APPGW_DEV</code></td>
                            <td><code>CW_NSG_APPGW_PROD</code></td>
                            <td>App Gateway subnet NSG</td>
                        </tr>
                        <tr>
                            <td>Public IP (App Gateway)</td>
                            <td><code>CW_PIP_APPGW_DEV</code></td>
                            <td><code>CW_PIP_APPGW_PROD</code></td>
                            <td>Frontend IP for ingress</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <button class="collapsible">Database Resources</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Resource</th>
                            <th>Development</th>
                            <th>Production</th>
                            <th>Purpose</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>SQL Database 1</td>
                            <td><code>CW_SQLDB_CWDB_DEV</code></td>
                            <td><code>CW_SQLDB_CWDB_PROD</code></td>
                            <td>Main application database</td>
                        </tr>
                        <tr>
                            <td>SQL Database 2</td>
                            <td><code>CW_SQLDB_UTIL_DEV</code></td>
                            <td><code>CW_SQLDB_UTIL_PROD</code></td>
                            <td>Utility database</td>
                        </tr>
                        <tr>
                            <td>SQL Database 3</td>
                            <td><code>CW_SQLDB_EMEA_DEV</code></td>
                            <td><code>CW_SQLDB_EMEA_PROD</code></td>
                            <td>Regional database</td>
                        </tr>
                        <tr>
                            <td>Cosmos Database</td>
                            <td><code>appdb-dev</code></td>
                            <td><code>appdb-prod</code></td>
                            <td>NoSQL database</td>
                        </tr>
                        <tr>
                            <td>Cosmos Container 1</td>
                            <td><code>products</code></td>
                            <td><code>products</code></td>
                            <td>Product catalog</td>
                        </tr>
                        <tr>
                            <td>Cosmos Container 2</td>
                            <td><code>users</code></td>
                            <td><code>users</code></td>
                            <td>User profiles</td>
                        </tr>
                        <tr>
                            <td>Cosmos Container 3</td>
                            <td>-</td>
                            <td><code>orders</code></td>
                            <td>Production only</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <button class="collapsible">Messaging Resources</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Resource Type</th>
                            <th>Name Pattern</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Service Bus Namespace</td>
                            <td><code>CW_SVCBUS_{ENV}</code></td>
                            <td>CW_SVCBUS_DEV</td>
                        </tr>
                        <tr>
                            <td>Queue - Orders</td>
                            <td><code>orders</code></td>
                            <td>orders (in CW_SVCBUS_DEV)</td>
                        </tr>
                        <tr>
                            <td>Queue - Notifications</td>
                            <td><code>notifications</code></td>
                            <td>notifications</td>
                        </tr>
                        <tr>
                            <td>Queue - Payments</td>
                            <td><code>payments</code></td>
                            <td>payments (prod only)</td>
                        </tr>
                        <tr>
                            <td>Topic - Events</td>
                            <td><code>events</code></td>
                            <td>events</td>
                        </tr>
                        <tr>
                            <td>Topic - Audit</td>
                            <td><code>audit</code></td>
                            <td>audit (prod only)</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <button class="collapsible">Compute & Storage Resources</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Resource</th>
                            <th>Naming Pattern</th>
                            <th>Example (DEV)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>AKS Node Pool</td>
                            <td><code>agentpool</code></td>
                            <td>agentpool (default)</td>
                        </tr>
                        <tr>
                            <td>AKS Managed Identity</td>
                            <td><code>CW_ID_AKS_{ENV}</code></td>
                            <td>CW_ID_AKS_DEV</td>
                        </tr>
                        <tr>
                            <td>Log Analytics Workspace</td>
                            <td><code>CW_LOG_{ENV}</code></td>
                            <td>CW_LOG_DEV</td>
                        </tr>
                        <tr>
                            <td>Storage Account (lowercase)</td>
                            <td><code>cwsa{purpose}{env}</code></td>
                            <td>cwsadiagdev</td>
                        </tr>
                        <tr>
                            <td>Key Vault (lowercase)</td>
                            <td><code>cw-kv-{env}</code></td>
                            <td>cw-kv-dev</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="warning-box">
                    <h4>‚ö†Ô∏è Storage Account Naming Constraints</h4>
                    <p>Storage accounts have strict naming requirements:</p>
                    <ul>
                        <li>Must be <strong>lowercase</strong> alphanumeric only (no hyphens, underscores)</li>
                        <li>3-24 characters length</li>
                        <li>Must be globally unique across all of Azure</li>
                        <li>Recommended: <code>cwsa{purpose}{env}{random}</code> (e.g., cwsadiagdev7x3k)</li>
                    </ul>
                </div>
            </div>

            <button class="collapsible">Private Endpoints</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Service</th>
                            <th>Private Endpoint Name</th>
                            <th>Private Link Resource</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Cosmos DB</td>
                            <td><code>CW_PE_COSMOS_DEV</code></td>
                            <td>Sql (NoSQL API)</td>
                        </tr>
                        <tr>
                            <td>SQL Server</td>
                            <td><code>CW_PE_SQLSRV_DEV</code></td>
                            <td>sqlServer</td>
                        </tr>
                        <tr>
                            <td>Storage Account</td>
                            <td><code>CW_PE_SA_DEV</code></td>
                            <td>blob</td>
                        </tr>
                        <tr>
                            <td>Key Vault</td>
                            <td><code>CW_PE_KV_DEV</code></td>
                            <td>vault</td>
                        </tr>
                        <tr>
                            <td>Service Bus (Premium)</td>
                            <td><code>CW_PE_SVCBUS_DEV</code></td>
                            <td>namespace</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>Resource Abbreviation Reference</h3>
            <table>
                <thead>
                    <tr>
                        <th>Full Name</th>
                        <th>Abbreviation</th>
                        <th>Usage Example</th>
                        <th>Azure Official</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Resource Group</td>
                        <td><code>RG</code></td>
                        <td>CW_RG_DEV</td>
                        <td>rg-*</td>
                    </tr>
                    <tr>
                        <td>Azure Kubernetes Service</td>
                        <td><code>AKS</code></td>
                        <td>CW_AKS_DEV</td>
                        <td>aks-*</td>
                    </tr>
                    <tr>
                        <td>SQL Server</td>
                        <td><code>SQLSRV</code></td>
                        <td>CW_SQLSRV_DEV</td>
                        <td>sql-*</td>
                    </tr>
                    <tr>
                        <td>SQL Database</td>
                        <td><code>SQLDB</code></td>
                        <td>CW_SQLDB_CWDB_DEV</td>
                        <td>sqldb-*</td>
                    </tr>
                    <tr>
                        <td>Cosmos DB</td>
                        <td><code>COSMOS</code></td>
                        <td>CW_COSMOS_DEV</td>
                        <td>cosmos-*</td>
                    </tr>
                    <tr>
                        <td>Service Bus</td>
                        <td><code>SVCBUS</code></td>
                        <td>CW_SVCBUS_DEV</td>
                        <td>sb-*</td>
                    </tr>
                    <tr>
                        <td>Application Gateway</td>
                        <td><code>APPGW</code></td>
                        <td>CW_APPGW_DEV</td>
                        <td>agw-*</td>
                    </tr>
                    <tr>
                        <td>API Management</td>
                        <td><code>APIM</code></td>
                        <td>CW_APIM_DEV</td>
                        <td>apim-*</td>
                    </tr>
                    <tr>
                        <td>Virtual Network</td>
                        <td><code>VNET</code></td>
                        <td>CW_VNET_DEV</td>
                        <td>vnet-*</td>
                    </tr>
                    <tr>
                        <td>Subnet</td>
                        <td><code>SUBNET</code></td>
                        <td>CW_SUBNET_WORK_DEV</td>
                        <td>snet-*</td>
                    </tr>
                    <tr>
                        <td>Network Security Group</td>
                        <td><code>NSG</code></td>
                        <td>CW_NSG_WORK_DEV</td>
                        <td>nsg-*</td>
                    </tr>
                    <tr>
                        <td>Public IP Address</td>
                        <td><code>PIP</code></td>
                        <td>CW_PIP_APPGW_DEV</td>
                        <td>pip-*</td>
                    </tr>
                    <tr>
                        <td>Private Endpoint</td>
                        <td><code>PE</code></td>
                        <td>CW_PE_COSMOS_DEV</td>
                        <td>pep-*</td>
                    </tr>
                    <tr>
                        <td>Managed Identity</td>
                        <td><code>ID</code></td>
                        <td>CW_ID_AKS_DEV</td>
                        <td>id-*</td>
                    </tr>
                    <tr>
                        <td>Log Analytics</td>
                        <td><code>LOG</code></td>
                        <td>CW_LOG_DEV</td>
                        <td>log-*</td>
                    </tr>
                    <tr>
                        <td>Storage Account</td>
                        <td><code>sa</code></td>
                        <td>cwsadiagdev</td>
                        <td>st*</td>
                    </tr>
                    <tr>
                        <td>Key Vault</td>
                        <td><code>kv</code></td>
                        <td>cw-kv-dev</td>
                        <td>kv-*</td>
                    </tr>
                </tbody>
            </table>

            <h3>Naming Convention Comparison</h3>
            <div class="card-grid">
                <div class="card">
                    <h4>Project Standard (CW)</h4>
                    <p><strong>Pattern:</strong> <code>CW_{RESOURCE}_{ENV}</code></p>
                    <p><strong>Examples:</strong></p>
                    <ul>
                        <li>CW_AKS_DEV</li>
                        <li>CW_SQLSRV_PROD</li>
                        <li>CW_APPGW_DEV</li>
                    </ul>
                    <p><strong>Benefits:</strong></p>
                    <ul>
                        <li>‚úì Clear project identification</li>
                        <li>‚úì Easy to scan and filter</li>
                        <li>‚úì Consistent uppercase format</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>Azure CAF Standard</h4>
                    <p><strong>Pattern:</strong> <code>{type}-{workload}-{env}-{location}-{instance}</code></p>
                    <p><strong>Examples:</strong></p>
                    <ul>
                        <li>aks-webapp-dev-eus2-001</li>
                        <li>sql-webapp-prod-eus2-001</li>
                        <li>agw-webapp-dev-eus2-001</li>
                    </ul>
                    <p><strong>Benefits:</strong></p>
                    <ul>
                        <li>‚úì Follows Microsoft recommendations</li>
                        <li>‚úì Includes location and instance</li>
                        <li>‚úì Self-documenting resource type</li>
                    </ul>
                </div>
            </div>

            <div class="info-box">
                <h4>üìù Implementation Notes</h4>
                <ul>
                    <li>To use these naming conventions, update parameter files (<code>main.dev.bicepparam</code> and <code>main.prod.bicepparam</code>)</li>
                    <li>Ensure names comply with Azure resource-specific constraints (length, character restrictions)</li>
                    <li>Storage Accounts and Key Vaults must follow special naming rules (lowercase, no special chars)</li>
                    <li>Consider DNS naming implications for public-facing services (Application Gateway, APIM)</li>
                    <li>Use consistent naming across linked resources (e.g., NSG name matches subnet name)</li>
                    <li>Document any exceptions or deviations from the standard in your repository README</li>
                </ul>
            </div>

            <h3>Sample Bicep Parameter Updates</h3>
            <pre><code>// main.dev.bicepparam - Updated with CW naming convention
using './main.bicep'

param environment = 'dev'
param location = 'eastus2'
param tags = {
  Environment: 'Development'
  Project: 'CW'
  ManagedBy: 'Bicep'
}

// Resource Group
param resourceGroupName = 'CW_RG_DEV'

// Networking
param vnetName = 'CW_VNET_DEV'
param appGatewayName = 'CW_APPGW_DEV'

// Compute
param aksClusterName = 'CW_AKS_DEV'

// Databases
param sqlServerName = 'CW_SQLSRV_DEV'  // Must be globally unique, lowercase
param cosmosDbAccountName = 'CW_COSMOS_DEV'  // Must be globally unique, lowercase

// Messaging & Integration
param serviceBusNamespaceName = 'CW_SVCBUS_DEV'  // Must be globally unique
param apimServiceName = 'CW_APIM_DEV'  // Must be globally unique</code></pre>

            <div class="warning-box">
                <h4>‚ö†Ô∏è Global Uniqueness Requirements</h4>
                <p>The following resources require <strong>globally unique names</strong> across all of Azure:</p>
                <ul>
                    <li><strong>Storage Accounts:</strong> Must be lowercase alphanumeric, 3-24 chars (e.g., cwsadiagdev7x3k)</li>
                    <li><strong>SQL Server:</strong> Must be lowercase, DNS-compliant (e.g., cw-sqlsrv-dev)</li>
                    <li><strong>Cosmos DB:</strong> Must be lowercase, DNS-compliant (e.g., cw-cosmos-dev)</li>
                    <li><strong>Service Bus:</strong> Must be DNS-compliant (e.g., cw-svcbus-dev)</li>
                    <li><strong>API Management:</strong> Must be DNS-compliant (e.g., cw-apim-dev)</li>
                    <li><strong>Key Vault:</strong> Must be 3-24 chars, alphanumeric and hyphens (e.g., cw-kv-dev)</li>
                </ul>
                <p><strong>Recommendation:</strong> Add a unique suffix (region code, random string, or timestamp) to ensure global uniqueness.</p>
            </div>

            <h3>Tagging Strategy</h3>
            <p>Comprehensive tagging strategy for resource organization, cost tracking, and compliance:</p>
            
            <button class="collapsible">Mandatory Tags</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Tag Name</th>
                            <th>Description</th>
                            <th>Example Value</th>
                            <th>Applied To</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>Environment</code></td>
                            <td>Deployment environment</td>
                            <td>Development, Production</td>
                            <td>All resources</td>
                        </tr>
                        <tr>
                            <td><code>Project</code></td>
                            <td>Project identifier</td>
                            <td>CW</td>
                            <td>All resources</td>
                        </tr>
                        <tr>
                            <td><code>CostCenter</code></td>
                            <td>Billing department</td>
                            <td>IT-Development, IT-Production</td>
                            <td>Resource groups</td>
                        </tr>
                        <tr>
                            <td><code>Owner</code></td>
                            <td>Responsible team/person</td>
                            <td>dev-team@company.com</td>
                            <td>Resource groups</td>
                        </tr>
                        <tr>
                            <td><code>ManagedBy</code></td>
                            <td>Management tool</td>
                            <td>Bicep, Terraform, Portal</td>
                            <td>All resources</td>
                        </tr>
                        <tr>
                            <td><code>CreatedDate</code></td>
                            <td>Resource creation date</td>
                            <td>2026-01-15</td>
                            <td>Resource groups</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <button class="collapsible">Optional Tags</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Tag Name</th>
                            <th>Description</th>
                            <th>Example Value</th>
                            <th>Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>Criticality</code></td>
                            <td>Business criticality level</td>
                            <td>Low, Medium, High, Critical</td>
                            <td>Incident prioritization</td>
                        </tr>
                        <tr>
                            <td><code>DataClassification</code></td>
                            <td>Data sensitivity level</td>
                            <td>Public, Internal, Confidential, Secret</td>
                            <td>Compliance and security</td>
                        </tr>
                        <tr>
                            <td><code>BusinessUnit</code></td>
                            <td>Business division</td>
                            <td>Engineering, Sales, Marketing</td>
                            <td>Organizational structure</td>
                        </tr>
                        <tr>
                            <td><code>Application</code></td>
                            <td>Application name</td>
                            <td>WebApplication, MobileAPI</td>
                            <td>Application grouping</td>
                        </tr>
                        <tr>
                            <td><code>SLA</code></td>
                            <td>Service level agreement</td>
                            <td>99.9, 99.95, 99.99</td>
                            <td>Availability requirements</td>
                        </tr>
                        <tr>
                            <td><code>BackupPolicy</code></td>
                            <td>Backup frequency</td>
                            <td>None, Daily, Weekly</td>
                            <td>Disaster recovery</td>
                        </tr>
                        <tr>
                            <td><code>MaintenanceWindow</code></td>
                            <td>Allowed maintenance time</td>
                            <td>Sat-02:00-06:00-UTC</td>
                            <td>Change management</td>
                        </tr>
                        <tr>
                            <td><code>ComplianceRequirement</code></td>
                            <td>Regulatory requirements</td>
                            <td>HIPAA, PCI-DSS, GDPR, SOC2</td>
                            <td>Compliance auditing</td>
                        </tr>
                        <tr>
                            <td><code>DisasterRecovery</code></td>
                            <td>DR configuration</td>
                            <td>None, Geo-Redundant, Active-Active</td>
                            <td>Business continuity</td>
                        </tr>
                        <tr>
                            <td><code>CostCode</code></td>
                            <td>Financial tracking code</td>
                            <td>CC-2026-001</td>
                            <td>Detailed cost allocation</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>DNS and FQDN Patterns</h3>
            <p>Fully Qualified Domain Names for publicly accessible resources:</p>
            
            <table>
                <thead>
                    <tr>
                        <th>Resource</th>
                        <th>FQDN Pattern</th>
                        <th>Development Example</th>
                        <th>Production Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>SQL Server</td>
                        <td><code>{name}.database.windows.net</code></td>
                        <td>cw-sqlsrv-dev.database.windows.net</td>
                        <td>cw-sqlsrv-prod.database.windows.net</td>
                    </tr>
                    <tr>
                        <td>Cosmos DB</td>
                        <td><code>{name}.documents.azure.com</code></td>
                        <td>cw-cosmos-dev.documents.azure.com</td>
                        <td>cw-cosmos-prod.documents.azure.com</td>
                    </tr>
                    <tr>
                        <td>Service Bus</td>
                        <td><code>{name}.servicebus.windows.net</code></td>
                        <td>cw-svcbus-dev.servicebus.windows.net</td>
                        <td>cw-svcbus-prod.servicebus.windows.net</td>
                    </tr>
                    <tr>
                        <td>API Management</td>
                        <td><code>{name}.azure-api.net</code></td>
                        <td>cw-apim-dev.azure-api.net</td>
                        <td>cw-apim-prod.azure-api.net</td>
                    </tr>
                    <tr>
                        <td>API Management (Custom)</td>
                        <td><code>api.{domain}</code></td>
                        <td>api-dev.contoso.com</td>
                        <td>api.contoso.com</td>
                    </tr>
                    <tr>
                        <td>Application Gateway</td>
                        <td><code>{pip-dns}.{region}.cloudapp.azure.com</code></td>
                        <td>cw-appgw-dev.eastus2.cloudapp.azure.com</td>
                        <td>cw-appgw-prod.eastus2.cloudapp.azure.com</td>
                    </tr>
                    <tr>
                        <td>App Gateway (Custom)</td>
                        <td><code>www.{domain}</code></td>
                        <td>www-dev.contoso.com</td>
                        <td>www.contoso.com</td>
                    </tr>
                    <tr>
                        <td>Key Vault</td>
                        <td><code>{name}.vault.azure.net</code></td>
                        <td>cw-kv-dev.vault.azure.net</td>
                        <td>cw-kv-prod.vault.azure.net</td>
                    </tr>
                    <tr>
                        <td>Storage Account (Blob)</td>
                        <td><code>{name}.blob.core.windows.net</code></td>
                        <td>cwsadiagdev.blob.core.windows.net</td>
                        <td>cwsadiagprod.blob.core.windows.net</td>
                    </tr>
                </tbody>
            </table>

            <h3>Lifecycle Management Resources</h3>
            <p>Naming conventions for backup, snapshot, and recovery resources:</p>
            
            <button class="collapsible">Backup and Snapshot Resources</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Resource Type</th>
                            <th>Naming Pattern</th>
                            <th>Example</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Recovery Services Vault</td>
                            <td><code>CW_RSV_{ENV}</code></td>
                            <td>CW_RSV_DEV</td>
                            <td>For VM and database backups</td>
                        </tr>
                        <tr>
                            <td>Backup Policy</td>
                            <td><code>CW_BP_{TYPE}_{ENV}</code></td>
                            <td>CW_BP_DAILY_PROD</td>
                            <td>Daily, Weekly, Monthly</td>
                        </tr>
                        <tr>
                            <td>Disk Snapshot</td>
                            <td><code>CW_SNAP_{DISK}_{YYYYMMDD}</code></td>
                            <td>CW_SNAP_AKSDISK_20260115</td>
                            <td>Include timestamp</td>
                        </tr>
                        <tr>
                            <td>SQL Point-in-Time</td>
                            <td><code>CW_SQLDB_{NAME}_PITR_{YYYYMMDD}</code></td>
                            <td>CW_SQLDB_CWDB_PITR_20260115</td>
                            <td>Point-in-time restore</td>
                        </tr>
                        <tr>
                            <td>Backup Storage Account</td>
                            <td><code>cwsabk{env}{random}</code></td>
                            <td>cwsabkdev7x3k</td>
                            <td>For custom backups</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <button class="collapsible">Disaster Recovery Resources</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Resource Type</th>
                            <th>Naming Pattern</th>
                            <th>Example</th>
                            <th>Purpose</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>DR Resource Group</td>
                            <td><code>CW_RG_{ENV}_DR</code></td>
                            <td>CW_RG_PROD_DR</td>
                            <td>Secondary region resources</td>
                        </tr>
                        <tr>
                            <td>DR VNet</td>
                            <td><code>CW_VNET_{ENV}_DR</code></td>
                            <td>CW_VNET_PROD_DR</td>
                            <td>Disaster recovery network</td>
                        </tr>
                        <tr>
                            <td>SQL Failover Group</td>
                            <td><code>CW_SQLFG_{ENV}</code></td>
                            <td>CW_SQLFG_PROD</td>
                            <td>Automatic SQL failover</td>
                        </tr>
                        <tr>
                            <td>Cosmos DB Secondary</td>
                            <td><code>CW_COSMOS_{ENV}_WUS2</code></td>
                            <td>CW_COSMOS_PROD_WUS2</td>
                            <td>West US 2 replica</td>
                        </tr>
                        <tr>
                            <td>Traffic Manager</td>
                            <td><code>CW_TM_{ENV}</code></td>
                            <td>CW_TM_PROD</td>
                            <td>Multi-region routing</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>Resource Naming Validation Rules</h3>
            
            <button class="collapsible">Azure Resource Naming Constraints</button>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th>Resource Type</th>
                            <th>Min Length</th>
                            <th>Max Length</th>
                            <th>Valid Characters</th>
                            <th>Case Sensitivity</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Resource Group</td>
                            <td>1</td>
                            <td>90</td>
                            <td>Alphanumeric, underscore, hyphen, period, parentheses</td>
                            <td>Case-insensitive</td>
                        </tr>
                        <tr>
                            <td>Storage Account</td>
                            <td>3</td>
                            <td>24</td>
                            <td>Lowercase letters and numbers only</td>
                            <td>Lowercase only</td>
                        </tr>
                        <tr>
                            <td>Virtual Network</td>
                            <td>2</td>
                            <td>64</td>
                            <td>Alphanumeric, underscore, hyphen, period</td>
                            <td>Case-insensitive</td>
                        </tr>
                        <tr>
                            <td>AKS Cluster</td>
                            <td>1</td>
                            <td>63</td>
                            <td>Alphanumeric and hyphen</td>
                            <td>Case-insensitive</td>
                        </tr>
                        <tr>
                            <td>SQL Server</td>
                            <td>1</td>
                            <td>63</td>
                            <td>Lowercase letters, numbers, hyphen (not at start/end)</td>
                            <td>Lowercase only</td>
                        </tr>
                        <tr>
                            <td>SQL Database</td>
                            <td>1</td>
                            <td>128</td>
                            <td>Most characters except <>*%&:\\/? or control chars</td>
                            <td>Case-insensitive</td>
                        </tr>
                        <tr>
                            <td>Cosmos DB</td>
                            <td>3</td>
                            <td>44</td>
                            <td>Lowercase letters, numbers, hyphen</td>
                            <td>Lowercase only</td>
                        </tr>
                        <tr>
                            <td>Service Bus</td>
                            <td>6</td>
                            <td>50</td>
                            <td>Alphanumeric and hyphen</td>
                            <td>Case-insensitive</td>
                        </tr>
                        <tr>
                            <td>Key Vault</td>
                            <td>3</td>
                            <td>24</td>
                            <td>Alphanumeric and hyphen (start with letter)</td>
                            <td>Case-insensitive</td>
                        </tr>
                        <tr>
                            <td>API Management</td>
                            <td>1</td>
                            <td>50</td>
                            <td>Alphanumeric and hyphen (start with letter)</td>
                            <td>Case-insensitive</td>
                        </tr>
                        <tr>
                            <td>App Gateway</td>
                            <td>1</td>
                            <td>80</td>
                            <td>Alphanumeric, underscore, hyphen, period</td>
                            <td>Case-insensitive</td>
                        </tr>
                        <tr>
                            <td>Public IP</td>
                            <td>1</td>
                            <td>80</td>
                            <td>Alphanumeric, underscore, hyphen, period</td>
                            <td>Case-insensitive</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>Multi-Instance Naming Patterns</h3>
            <p>For resources requiring multiple instances or regional deployments:</p>
            
            <table>
                <thead>
                    <tr>
                        <th>Scenario</th>
                        <th>Pattern</th>
                        <th>Examples</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Multiple AKS Node Pools</td>
                        <td><code>{cluster}-{purpose}</code></td>
                        <td>
                            agentpool (system)<br/>
                            userpool (user workloads)<br/>
                            gpupool (ML workloads)
                        </td>
                    </tr>
                    <tr>
                        <td>Multiple Subnets</td>
                        <td><code>CW_SUBNET_{PURPOSE}_{ENV}</code></td>
                        <td>
                            CW_SUBNET_WORK_DEV<br/>
                            CW_SUBNET_APPGW_DEV<br/>
                            CW_SUBNET_DB_DEV
                        </td>
                    </tr>
                    <tr>
                        <td>Multiple Databases</td>
                        <td><code>CW_SQLDB_{NAME}_{ENV}</code></td>
                        <td>
                            CW_SQLDB_CWDB_DEV<br/>
                            CW_SQLDB_UTIL_DEV<br/>
                            CW_SQLDB_EMEA_DEV
                        </td>
                    </tr>
                    <tr>
                        <td>Multi-Region Deployment</td>
                        <td><code>CW_{RESOURCE}_{ENV}_{REGION}</code></td>
                        <td>
                            CW_AKS_PROD_EUS2<br/>
                            CW_AKS_PROD_WUS2<br/>
                            CW_AKS_PROD_CUS
                        </td>
                    </tr>
                    <tr>
                        <td>Numbered Instances</td>
                        <td><code>CW_{RESOURCE}_{ENV}_{NN}</code></td>
                        <td>
                            CW_VNET_DEV_01<br/>
                            CW_VNET_DEV_02<br/>
                            CW_VNET_DEV_03
                        </td>
                    </tr>
                    <tr>
                        <td>Application-Specific</td>
                        <td><code>CW_{RESOURCE}_{APP}_{ENV}</code></td>
                        <td>
                            CW_AKS_WEB_DEV<br/>
                            CW_AKS_API_DEV<br/>
                            CW_AKS_BATCH_DEV
                        </td>
                    </tr>
                </tbody>
            </table>

            <h3>Naming Convention Exceptions</h3>
            <div class="card">
                <h4>Documented Exceptions</h4>
                <p>Cases where standard naming cannot be applied:</p>
                <ul>
                    <li><strong>Legacy Resources:</strong> Existing resources that predate the naming standard (document in inventory)</li>
                    <li><strong>Third-Party Integrations:</strong> External services requiring specific naming patterns</li>
                    <li><strong>Azure Limitations:</strong> Services with restrictive naming requirements (e.g., Storage Accounts)</li>
                    <li><strong>Global Uniqueness:</strong> When preferred name is taken, add suffix: <code>CW_SQLSRV_DEV_EUS2</code></li>
                    <li><strong>Kubernetes Resources:</strong> Follow k8s conventions (lowercase, hyphen-separated): <code>cw-web-app-dev</code></li>
                </ul>
            </div>

            <h3>Implementation Checklist</h3>
            <div class="card">
                <h4>‚úÖ Naming Standard Adoption Steps</h4>
                <ol>
                    <li>‚úì Review and approve naming convention with stakeholders</li>
                    <li>‚úì Update Bicep parameter files (<code>main.dev.bicepparam</code>, <code>main.prod.bicepparam</code>)</li>
                    <li>‚úì Validate names against Azure constraints (length, characters, uniqueness)</li>
                    <li>‚úì Test deployment in development environment</li>
                    <li>‚úì Document any exceptions or deviations in README</li>
                    <li>‚úì Create resource naming validation script (PowerShell/Python)</li>
                    <li>‚úì Update CI/CD pipelines with naming validation</li>
                    <li>‚úì Apply mandatory tags to all resources</li>
                    <li>‚úì Create Azure Policy for naming enforcement (optional)</li>
                    <li>‚úì Train team members on naming standards</li>
                    <li>‚úì Schedule quarterly review of naming conventions</li>
                </ol>
            </div>

            <h3>Naming Validation Script Example</h3>
            <pre><code># PowerShell script to validate CW naming convention
function Test-CWNamingConvention {
    param(
        [string]$ResourceName,
        [string]$ResourceType,
        [string]$Environment
    )
    
    # Expected pattern: CW_{RESOURCE}_{ENV}
    $pattern = "^CW_[A-Z]+_(DEV|PROD)$"
    
    if ($ResourceName -notmatch $pattern) {
        Write-Warning "Resource '$ResourceName' does not follow CW naming convention"
        return $false
    }
    
    # Check environment suffix
    if ($ResourceName -notlike "*_$Environment") {
        Write-Warning "Resource '$ResourceName' does not match environment '$Environment'"
        return $false
    }
    
    # Check resource-specific constraints
    switch ($ResourceType) {
        "StorageAccount" {
            if ($ResourceName -cmatch '[A-Z_]') {
                Write-Error "Storage Account must be lowercase alphanumeric only"
                return $false
            }
            if ($ResourceName.Length -gt 24) {
                Write-Error "Storage Account name exceeds 24 characters"
                return $false
            }
        }
        "KeyVault" {
            if ($ResourceName.Length -gt 24) {
                Write-Error "Key Vault name exceeds 24 characters"
                return $false
            }
        }
        "SqlServer" {
            if ($ResourceName -cnotmatch '^[a-z]') {
                Write-Error "SQL Server must start with lowercase letter"
                return $false
            }
        }
    }
    
    Write-Host "‚úì Resource name '$ResourceName' is valid" -ForegroundColor Green
    return $true
}

# Example usage
Test-CWNamingConvention -ResourceName "CW_AKS_DEV" -ResourceType "AKS" -Environment "DEV"
Test-CWNamingConvention -ResourceName "cwsadiagdev" -ResourceType "StorageAccount" -Environment "DEV"</code></pre>

            <div class="info-box">
                <h4>üîó Additional Resources</h4>
                <ul>
                    <li><a href="https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming" target="_blank">Azure Naming Conventions - Cloud Adoption Framework</a></li>
                    <li><a href="https://learn.microsoft.com/azure/azure-resource-manager/management/resource-name-rules" target="_blank">Azure Resource Naming Rules and Restrictions</a></li>
                    <li><a href="https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-abbreviations" target="_blank">Recommended Abbreviations for Azure Resources</a></li>
                    <li><a href="https://learn.microsoft.com/azure/governance/policy/samples/pattern-tags" target="_blank">Azure Policy for Tag Governance</a></li>
                </ul>
            </div>
        </section>
    </div>

    <!-- ==================== FOOTER ==================== -->
    <footer class="footer">
        <div class="container">
            <p><strong>Azure Infrastructure - Low-Level Design Documentation</strong></p>
            <p>Version 1.0.0 | January 15, 2026</p>
            <p>Generated from Bicep Infrastructure as Code</p>
        </div>
    </footer>

    <!-- ==================== JAVASCRIPT ==================== -->
    <script>
        // Initialize Mermaid
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });

        // Collapsible sections functionality
        document.addEventListener('DOMContentLoaded', function() {
            const collapsibles = document.querySelectorAll('.collapsible');
            
            collapsibles.forEach(function(collapsible) {
                collapsible.addEventListener('click', function() {
                    this.classList.toggle('active');
                    const content = this.nextElementSibling;
                    
                    if (content.classList.contains('active')) {
                        content.classList.remove('active');
                    } else {
                        content.classList.add('active');
                    }
                });
            });

            // Smooth scrolling for anchor links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
        });
    </script>
</body>
</html>